/* ORGanizer for Salesforce - v10000.0.9.53 
 * Author: Enrico Murru (https://organizer.solutions/)
 * Copyright 2016-2024
 */
!function(exports,global){define("code-coverage",["global","constants","jquery","popup-utils","salesforce-client"],function($G,$C,$,PopupUtils,$SalesforceClient){"use sctrict";function showCoverage(){PopupUtils.sendAnalyticsEventToBackground($C.Analytics.EVENTS.CONTENT_ACTION.Actions.SHOW_COVERAGE.name,$C.Analytics.EVENTS.CONTENT_ACTION.name);var container=$('[id="'+(_isClass?"ApexClassViewPage":"ApexTriggerViewPage")+":theTemplate:theForm:thePageBlock:"+(_isClass?"class":"tigger")+'CodeTab"]'),tdContainer=container.find("pre.codeBlock table tbody tr td")[1],tdLineNumbers=container.find("pre.codeBlock table tbody tr td")[0];_originalContent||(_originalContent=$(tdContainer).html());var contentList=_originalContent.split("<br>"),query="select id, Coverage from apexcodecoverage  where ApexClassorTriggerId= '"+_classOrTriggerId+"'";$client.toolingAPIQuery(query,function(err,rslt){if(debug.log(query,err,rslt),!err&&rslt&&rslt.records&&rslt.records.length){for(var i=0;i<rslt.records.length;i++){var cov=rslt.records[i].Coverage;if(!cov||!cov.coveredLines&&!cov.uncoveredLines)return;for(var c=0;c<cov.coveredLines.length;c++){var index=cov.coveredLines[c];contentList[index-1].indexOf("ui-apex-covered-line")>=0||(contentList[index-1].indexOf("ui-apex-uncovered-line")>=0&&(contentList[index-1]=contentList[index-1].replace("ui-apex-uncovered-line","ui-apex-covered-line")),contentList[index-1]='<span class="ui-apex-covered-line">'+contentList[index-1]+"</span>")}for(var c=0;c<cov.uncoveredLines.length;c++){var index=cov.uncoveredLines[c];contentList[index-1].indexOf("ui-apex-uncovered-line")>=0||contentList[index-1].indexOf("ui-apex-covered-line")>=0||(contentList[index-1]='<span class="ui-apex-uncovered-line">'+contentList[index-1]+"</span>")}}$(tdLineNumbers).addClass("ui-apex-code-line"),$(tdContainer).addClass("ui-apex-code-line").html(contentList.join("<br/>"))}})}var _isLex,_domainAPI,_sid,_classOrTriggerId,_originalContent,_isClass,$client,_isInitialized=!1,_apiLevel="41.0",debug=PopupUtils.newDebugger("CodeCoverage"),init=function(isLex,domainAPI,sid,apiLevel){if(!_isInitialized){_isInitialized=!0,_isLex=isLex,_domainAPI=domainAPI,_sid=sid,_apiLevel=apiLevel||_apiLevel;var idParam=PopupUtils.getURLParameter("id");if(!PopupUtils.checkIfSobjectPage(!1)&&!idParam)return debug.log("Not an Sobject page",idParam,window.location.href);if(_classOrTriggerId=PopupUtils.getSFIdFromUrl(window.location.href,!1),_classOrTriggerId=_classOrTriggerId&&PopupUtils.isSalesforceId(_classOrTriggerId)?_classOrTriggerId:idParam,!_classOrTriggerId||0!==_classOrTriggerId.indexOf("01p")&&0!==_classOrTriggerId.indexOf("01q"))return debug.log("Not a trigger/class: "+_classOrTriggerId);_isClass=0===_classOrTriggerId.indexOf("01p"),$client=new $SalesforceClient.Client("https://"+_domainAPI,_sid,_apiLevel),debug.log("Plugin initialized.");var pabeBlockButtons=$('[id="'+(_isClass?"ApexClassViewPage":"ApexTriggerViewPage")+':theTemplate:theForm:thePageBlock:thePageBlockButtons"]'),pabeBlockButtonsBottom=$('[id="'+(_isClass?"ApexClassViewPage":"ApexTriggerViewPage")+':theTemplate:theForm:thePageBlock:thePageBlockButtons:bottom"]'),calculateBtn=$("<button/>").attr("title","ORGanizer - Click to show class/trigger coverage").attr("type","button").addClass("btn ui-organizer-input").click(showCoverage).append("<span>Show Coverage</span>");pabeBlockButtons.append(calculateBtn),pabeBlockButtonsBottom.append(calculateBtn.clone(!0));var container=$('[id="'+(_isClass?"ApexClassViewPage":"ApexTriggerViewPage")+":theTemplate:theForm:thePageBlock:"+(_isClass?"class":"tigger")+'CodeTab"]'),tdContainer=container.find("pre.codeBlock table tbody tr td")[1],tdLineNumbers=container.find("pre.codeBlock table tbody tr td")[0];$(tdContainer).addClass("ui-apex-code-line"),$(tdLineNumbers).addClass("ui-apex-code-line")}},Plugin={init:init};return Plugin}),global.true=exports}({},function(){return this}());