/* ORGanizer for Salesforce - v10000.0.9.53 
 * Author: Enrico Murru (https://organizer.solutions/)
 * Copyright 2016-2024
 */
!function(exports,global){define("console-plugins",["global","constants","jquery","codemirror","popup-utils","salesforce-client","game-space-invaders","blockrain","jquery-ui","jquery-datatables","bootstrap-datatables","codemirror-sql","codemirror-clike","json-viewer","codemirror-show-hint","codemirror-soql-hint"],function($G,$C,$,CodeMirror,PopupUtils,$SalesforceClient,SpaceInvaders,Blockrain){"use sctrict";function resetFormatting(v){return $("<span/>").html($("<span/>").text(v).html().replace(/\[_b_\]/gi,"<b>").replace(/\[_\/b_\]/gi,"</b>")).html()}var chrome=$G.chrome,debug=PopupUtils.newDebugger("ORGanizer: console-plugins"),sendAnalyticsEvent=function(action){PopupUtils.sendAnalyticsEventToBackground(action,$C.Analytics.EVENTS.QUICKCONSOLE_ACTION.name)},$PluginUtils=function(){return{convertId:function(id){if(!id)return id;if(id=id.replace(/\"/g,""),15!=id.length)return id;for(var suffix="",i=0;i<3;i++){for(var flags=0,j=0;j<5;j++){var c=id.charAt(5*i+j);c>="A"&&c<="Z"&&(flags+=1<<j)}suffix+=flags<=25?"ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(flags):"012345".charAt(flags-26)}return id+suffix},isSalesforceId:function(id){return PopupUtils.isSalesforceId(id)},checkIfSobjectPage:function(isLex){return PopupUtils.checkIfSobjectPage(isLex)},createSpinner:function(msg){return msg=msg||"",'<div class="text-center"><img src="'+chrome.runtime.getURL("/img/spin.gif")+'" /> <span>'+msg+"</span></div>"},createError:function(errorObj){debug.log("createError",errorObj);var msg="Unhandled error!",arr=[];if("object"==typeof errorObj&&errorObj.message?arr.push(errorObj):arr=Array.isArray(errorObj)?errorObj:arr.concat({message:""+errorObj,errorCode:"666"}),arr.length){msg="";for(var i=0;i<arr.length;i++)msg+="["+arr[i].errorCode+"] "+resetFormatting(arr[i].message).replace("\n","<br/>")}return'<div class="alert alert-danger" role="alert"><span style="font-size:11pt">'+msg+"</span></div>"},getSFIdFromUrl:function(url,isLex){return PopupUtils.getSFIdFromUrl(url,isLex)},getDescendantProp:function(obj,desc){for(var arr=desc.split(".");arr.length&&(obj=obj[arr.shift()]););return obj},createModal:function(title){title=title||"";var modal=$('<div class="modal fade out" tabindex="-1" role="dialog"><div class="modal-dialog"><div class="modal-content panel-primary"><div class="modal-header panel-heading"><h4 class="modal-title"></h4><button type="button" class="close ui-modal-close-btn" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Ã—</span></button></div><div class="modal-body"></div><div class="modal-footer"></div></div></div></div>');return modal.find(".modal-title").html(title),modal},getUniqueId:function(){return Math.random().toString().replace(".","")}}}(),$SFORG_PLUGIN_00000=function(){var $client,_container=$("<div />"),_headerContainer=$('<div class="well well-small ui-plugin-container"><div class="ui-top-header" /></div>');_container.append(_headerContainer),_headerContainer.find(".ui-top-header").append('<h4>Home <small class="text-muted">Current organization info</small></h4>');var _results=$('<div class="form-horizontal" style="width:90%"><div class="form-group"><div class="col-xs-2 text-center"><label class="control-label">Org ID</label></div><div class="col-xs-9 "><input class="form-control input-sm ui-home-org-id" readonly="readonly"/></div></div><div class="form-group"><div class="col-xs-2 text-center"><label class="control-label">Domain</label></div><div class="col-xs-9 "><input class="form-control input-sm ui-home-domain" readonly="readonly"/></div></div><div class="form-group"><div class="col-xs-2 text-center"><label class="control-label">Session ID</label></div><div class="col-xs-9 "><span class="form-control-static ui-home-discover-sid" style="cursor: pointer; text-decoration:underline;">click to show</span><input class="form-control input-sm ui-home-sid" readonly="readonly"/></div></div><div class="form-group"><div class="col-xs-2 text-center"><label class="control-label ui-org-info">ORG Info</label></div><div class="col-xs-9"><span class="form-control-static ui-home-discover-oinfo" style="cursor: pointer; text-decoration:underline;">show ORG info</span><pre class="ui-home-oinfo"/></div></div><div class="form-group"><div class="col-xs-2 text-center"><label class="control-label ui-org-info">ORG Limits</label></div><div class="col-xs-9"><span class="form-control-static ui-home-discover-olimits" style="cursor: pointer; text-decoration:underline;">show ORG Limits</span><pre class="ui-home-olimits"/></div></div><div class="form-group"><div class="col-xs-2 text-center"><label class="control-label ui-org-info">User Info</label></div><div class="col-xs-9"><span class="form-control-static ui-home-discover-uinfo" style="cursor: pointer; text-decoration:underline;">show user info</span><pre class="ui-home-uinfo"/></div></div><div class="form-group"><div class="col-xs-2 text-center"><label class="control-label ui-org-info">Apex Test Coverage</label></div><div class="col-xs-9"><span class="form-control-static ui-home-discover-coverage" style="cursor: pointer; text-decoration:underline;">calculate coverage</span><pre class="ui-home-coverage"/></div></div></div>');return _container.append(_results),_container.find(".ui-org-info").each(function(){$(this).css("cursor","pointer"),$(this).parent().parent().find("pre").css("max-height","200px")}),{title:"Home",id:$C.Plugins.$SFORG_PLUGIN_00000,type:"TAB",manifestVersion:"1.0",description:"...","wiki-url":"http://www.wwww.com",create:function(options,tabState){return _container.find(".ui-home-org-id").val(options.orgId),_container.find(".ui-home-domain").val(options.serverUrl),_container.find(".ui-home-sid").val(options.sessionId).hide(),_container.find(".ui-home-discover-sid").click(function(){$(this).hide(),_container.find(".ui-home-sid").show()}),_container.find(".ui-home-discover-uinfo").click(function(){$(this).append($PluginUtils.createSpinner()),$client.getUserInfo(function(err,uinfo){if(console.log(err,uinfo),_container.find(".ui-home-uinfo").show(),_container.find(".ui-home-discover-uinfo").hide(),err)return _container.find(".ui-home-discover-uinfo").show().html("show user info"),_container.find(".ui-home-uinfo").html(JSON.stringify(err,null,2));for(var key in uinfo)if(uinfo.hasOwnProperty(key)){var info=uinfo[key],item=$("<p><strong />: <span/></p>");item.find("strong").text(key),item.find("span").text(info),_container.find(".ui-home-uinfo").append(item)}sendAnalyticsEvent($C.Analytics.EVENTS.QUICKCONSOLE_ACTION.Actions.TAB_GET_USER_INFO.name)})}),_container.find(".ui-home-uinfo").hide(),_container.find(".ui-home-discover-oinfo").click(function(){$(this).append($PluginUtils.createSpinner()),$client.getObject(options.orgId,function(err,uinfo){if(_container.find(".ui-home-oinfo").show(),_container.find(".ui-home-discover-oinfo").hide(),err)return _container.find(".ui-home-discover-oinfo").show().html("show ORG info"),_container.find(".ui-home-oinfo").html(JSON.stringify(err,null,2));delete uinfo.Address,delete uinfo.attributes;for(var key in uinfo)if(uinfo.hasOwnProperty(key)){var info=uinfo[key],strong=$("<strong/>").text(key),span=$("<span/>").text(":"+info),item=$("<p/>").append(strong).append(span);_container.find(".ui-home-oinfo").append(item)}sendAnalyticsEvent($C.Analytics.EVENTS.QUICKCONSOLE_ACTION.Actions.TAB_GET_ORG_INFO.name)})}),_container.find(".ui-home-oinfo").hide(),_container.find(".ui-home-discover-olimits").click(function(){$(this).append($PluginUtils.createSpinner()),$client.getORGlimits(function(err,olimits){if(_container.find(".ui-home-olimits").html("").show(),_container.find(".ui-home-discover-olimits").html("Refresh ORG limits"),err)return _container.find(".ui-home-discover-olimits").show().html("show ORG Limits"),_container.find(".ui-home-olimits").html(JSON.stringify(err,null,2));for(var key in olimits)if(olimits.hasOwnProperty(key)){var limit=olimits[key],strong=$("<strong/>").text(key),span=$("<span/>").text(": "+limit.Remaining+" / "+limit.Max),item=$("<p/>").append(strong).append(span);_container.find(".ui-home-olimits").append(item)}sendAnalyticsEvent($C.Analytics.EVENTS.QUICKCONSOLE_ACTION.Actions.TAB_GET_ORG_LIMITS.name)})}),_container.find(".ui-home-olimits").hide(),_container.find(".ui-home-discover-coverage").click(function(){$(this).append($PluginUtils.createSpinner()),_container.find(".ui-home-coverage").html("").hide(),$client.toolingAPIQuery("Select+id,ApexClassorTrigger.Name,NumLinesCovered,NumLinesUncovered+from+ApexCodeCoverageAggregate+order+by+ApexClassorTrigger.Name",function(err,data){if(err)return _container.find(".ui-home-discover-coverage").show().html("calculate coverage"),_container.find(".ui-home-coverage").html(JSON.stringify(err,null,2));_container.find(".ui-home-coverage").html("").show(),_container.find(".ui-home-discover-coverage").html("refresh coverage");for(var csvList=["Name;Total Lines;Lines Covered;Lines Uncovered;Percentage Covered"],totalLines=0,totalCoveredLines=0,i=0;i<data.records.length;i++){var c=data.records[i];if(debug.warn("Found Apex/Trigger without Name: ",c),c.ApexClassOrTrigger){var numLinesUncovered=c.NumLinesUncovered?c.NumLinesUncovered:0,numLinesCovered=c.NumLinesCovered?c.NumLinesCovered:0;totalLines=totalLines+numLinesCovered+numLinesUncovered,totalCoveredLines+=numLinesCovered;var covPerc=numLinesCovered+numLinesUncovered>0?Math.round(100*parseFloat(numLinesCovered)/parseFloat(numLinesUncovered+numLinesCovered)):0,row=c.ApexClassOrTrigger.Name+";"+(numLinesCovered+numLinesUncovered)+";"+numLinesCovered+";"+numLinesUncovered+";"+covPerc.toString();csvList.push(row)}}var totalCovPerc=totalLines+totalCoveredLines>0?Math.round(100*parseFloat(totalCoveredLines)/parseFloat(totalLines)):0;csvList.splice(1,0,"## Overall ##;"+totalLines+";"+totalCoveredLines+";"+(totalLines-totalCoveredLines)+";"+totalCovPerc);var coverageResultTxt=$('<div style="font-size:12pt">Coverage Result: <strong class="ui-cov-rslt"></strong></div>'),rslt=coverageResultTxt.find(".ui-cov-rslt").text(totalCovPerc+"%");totalCovPerc<70?rslt.addClass("text-danger"):totalCovPerc>=70&&totalCovPerc<75?rslt.addClass("text-warning"):rslt.addClass("text-success");var downloadLink=$('<div><br/><a class="ui-pointer">Download report...</a></div>');downloadLink.find("a").click(function(){PopupUtils.triggerDownloadTextFileFromBackground("apex_coverage_report_"+(new Date).getTime()+".csv","text/csv",csvList.join("\n"),!1)});var errorsLink=$('<div><br/><a href="/07M" target="_blank"><small>Jump to Apex Test results...</small></a></div>');_container.find(".ui-home-coverage").append(coverageResultTxt).append(downloadLink).append(errorsLink),sendAnalyticsEvent($C.Analytics.EVENTS.QUICKCONSOLE_ACTION.Actions.TAB_GET_ORG_COVERAGE.name)})}),_container.find(".ui-home-coverage").hide(),$client=new $SalesforceClient.Client(options.serverUrl,options.sessionId,options.apiLevel),_container},onFocus:function(){},onBlur:function(){}}}(),$SFORG_PLUGIN_00001=function(){function handleWarning(msg){_results.html($PluginUtils.createError(msg))}function handleLoading(msg){msg=msg||"Loading results...",_results.html($PluginUtils.createSpinner(msg))}var $client,_orgId,_isLex=!1,_inputSearch=$('<input type="text" class="form-control input-sm " placeholder="Filter fields..." />');_inputSearch.on("keyup",function(){filterFields($(this).val())});var _inputId=$('<input type="text" class="form-control input-sm " maxlength="18" placeholder="Sobject ID" />'),_btnRefresh=$('<button class="btn btn-default btn-sm btn-block" title="Click to query all current fields object">Query all fields</button>');_btnRefresh.click(function(){showObjectDetails(window.location.href,_inputId.val())});var _btnGetIDFromUrl=$('<div style="width:100%; text-align:center"><a class="mouse-pointer" title="Copy current record ID, if any">Get record ID from current page</a></div>');_btnGetIDFromUrl.click(function(){var id=getSFIdFromURL(_isLex);_inputId.val(id)});var _idsHistory=$('<select class="form-control input-sm ui-soql-history-slct" style="height: 25px; font-size: 8pt;" />');_idsHistory.on("change",function(){_inputId.val(_idsHistory.val()),_btnRefresh.click()});var _filterShowEditing=$('<div class="ui-pointer"><span class="fa fa-square-o ui-checkbox"/> Show fields in editing</div>');_filterShowEditing.click(function(){var _showEditOnly=!1;"true"!==$(this).attr("data-value")?(_showEditOnly=!0,_filterShowEditing.attr("data-value","true"),_filterShowEditing.find(".ui-checkbox").removeClass("fa-square-o").addClass("fa-check-square-o")):(_showEditOnly=!1,_filterShowEditing.attr("data-value","false"),_filterShowEditing.find(".ui-checkbox").addClass("fa-square-o").removeClass("fa-check-square-o")),showOnlyEditing(_showEditOnly)});var _saveAllButton=$('<button class="btn btn-xs btn-default btn-block">Save All</button>'),_container=$("<div />"),_headerContainer=$('<div class="well well-small ui-plugin-container"><div class="ui-top-header" /><div class="row"><div class="col-xs-4 ui-middle-left-header"></div><div class="col-xs-4 ui-middle-center-header"></div><div class="col-xs-4 ui-middle-right-header"></div></div><br /><div class="row"><div class="col-xs-4 ui-bottom-left-header"></div><div class="col-xs-4 ui-bottom-center-header"></div><div class="col-xs-4 ui-bottom-right-header"></div></div></div>');_container.append(_headerContainer);var _historyContainer=$('<div class="row"/>');_historyContainer.append($('<div class="col-xs-1"><small class="text-muted">History</small><br/><br/></div>')).append($('<div class="col-xs-11 historySlct"></div>')),_historyContainer.find(".historySlct").append(_idsHistory),_headerContainer.find(".ui-top-header").append('<h4>SObject Fields <small class="text-muted">Query all fields of an sobject.</small></h4>').append(_historyContainer),_headerContainer.find(".ui-middle-right-header").append(_btnRefresh),_headerContainer.find(".ui-bottom-right-header").append(_filterShowEditing).append(_inputSearch).append(_saveAllButton),_headerContainer.find(".ui-middle-center-header").append(_inputId),_headerContainer.find(".ui-middle-left-header").append(_btnGetIDFromUrl);var _results=$("<div />");_container.append(_results);var _pluginHistory={objects:[]},showOnlyEditing=function(show){_results.find("table tr").each(function(){!$(this).hasClass("ui-edit-mode")&&show?$(this).hide():$(this).show()})},refreshPluginHistory=function(){PopupUtils.getPluginStorage($SFORG_PLUGIN_00001.id,_orgId,function(err,data){data&&data.objects&&data.objects.length&&(_pluginHistory=data),_idsHistory.html("");for(var i=_pluginHistory.objects.length-1;i>=0;i--){var dt=_pluginHistory.objects[i].lastModifiedDate?new Date(_pluginHistory.objects[i].lastModifiedDate).toISOString().replace("T"," ").split(".")[0]:"-",opt=$("<option />");opt.attr("title","Last executed: "+dt+"\n"+_pluginHistory.objects[i].name),opt.attr("value",_pluginHistory.objects[i].id),opt.html($("<span/>").text(_pluginHistory.objects[i].name.substring(0,100)+(_pluginHistory.objects[i].name.length>100?"...":"")).html()+" - "+dt),_idsHistory.append(opt)}})},filterFields=function(filter){return(filter=(filter||"").toLowerCase())?void _results.find(".ui-field-label").each(function(){var label=$(this),value=label.closest("tr").find(".ui-field-value").val()||"";label.attr("data-field-name").indexOf(filter)<0&&label.attr("data-field-label").indexOf(filter)<0&&value.toLowerCase().indexOf(filter)<0?label.parent().parent().hide():label.parent().parent().show()}):void _results.find("tr").show()},showObjectDetails=function(url,objid){var id=objid||"";if(id=id.trim(),!id)try{id=$PluginUtils.getSFIdFromUrl(url)}catch(ex){return handleWarning("Invalid Sobject URL ["+url+"]")}return $PluginUtils.isSalesforceId(id)?(handleLoading(),void $client.getObject(id,function(err,data,describe){if(err)return handleWarning(err);debug.log("Object Fields",err,data,describe);var nameFields=[];for(var key in describe.fields)if(describe.fields.hasOwnProperty(key)){var nf=describe.fields[key];nf.nameField&&nameFields.push({name:nf.name,value:data[nf.name]})}for(var i=_pluginHistory.objects.length-1;i>=0;i--){var obj=_pluginHistory.objects[i];data.Id===obj.id&&_pluginHistory.objects.splice(i,1)}_pluginHistory.objects.push({id:data.Id,name:data.Id+" - ["+describe.name+"] "+(nameFields.length?nameFields[0].value:""),lastModifiedDate:(new Date).getTime()}),_pluginHistory.objects.length>50&&_pluginHistory.objects.splice(0,_pluginHistory.objects.length-50),PopupUtils.setPluginStorage($SFORG_PLUGIN_00001.id,_orgId,_pluginHistory,function(err,ph){refreshPluginHistory()}),_inputSearch.val(""),_filterShowEditing.attr("data-value","true"),_filterShowEditing.click(),_headerContainer.find(".ui-bottom-center-header").html('<div class="text-center"><h4><span /> <small></small></h4><h5/></div>'),_headerContainer.find(".ui-bottom-center-header h4").find("span").text(describe.name).find("small").text(describe.label&&describe.label!=describe.name?describe.label:""),_headerContainer.find(".ui-bottom-center-header h5").text(nameFields.length?nameFields[0].value:"");var _downloadLinks=$('<div>Download data ( <small class="ui-download-sobject-json" style="cursor:pointer;">json</small> | <small class="ui-download-sobject-csv" style="cursor:pointer;">csv</small> )</div>');_downloadLinks.find(".ui-download-sobject-json").click(function(){PopupUtils.triggerDownloadTextFileFromBackground(data.Id+"_"+(new Date).getTime()+".json","text/json",JSON.stringify(data,null,2),!1)}),_downloadLinks.find(".ui-download-sobject-csv").click(function(){var firstRow=[],secondRow=[];for(var key in data)if(data.hasOwnProperty(key)&&"object"!=typeof data[key]){firstRow.push(key);var val=data[key];val=null===val||"undefined"==typeof val?"":(""+val).replace('"','""'),secondRow.push(val)}var csv='"'+firstRow.join('","')+'"\n"'+secondRow.join('","')+'"';PopupUtils.triggerDownloadTextFileFromBackground(data.Id+"_"+(new Date).getTime()+".csv","text/csv",csv,!1)});var _formContainer=$('<table class="table table-hover"/>'),sortedNames=Object.keys(describe.fields).sort();for(var fname in sortedNames){var field=sortedNames[fname],isCalculated=describe.fields[field].calculated||!describe.fields[field].updateable||describe.fields[field].autoNumber,itemHtml='<tr><td><label class="ui-field-label control-label" ><span style="font-family:monospace; font-size:10pt">'+field+'</span><br/><span style="font-size: 8pt;">'+describe.fields[field].label+'</span></label></td><td class="text-right">';itemHtml+='<textarea rows="1" class="form-control input-sm ui-field-value" readonly="readonly" />',itemHtml+="<small>"+describe.fields[field].type+"</small>",itemHtml+="</td>",isCalculated||(itemHtml+='<td><div class="fa fa-save ui-save-btn" style="cursor:pointer; font-size:14pt;" title="Save value">&nbsp;</div><div class="fa fa-edit ui-edit-btn" style="cursor:pointer; font-size:14pt;" title="Edit value">&nbsp;</div><div class="fa fa-undo ui-cancel-btn" style="cursor:pointer; font-size:14pt;" title="Rollback">&nbsp;</div><small class="ui-spinner-value"/></td>'),itemHtml+="</tr>";var _item=$(itemHtml);if(_item.find(".control-label").attr("data-field-name",field.toLowerCase()).attr("data-field-label",describe.fields[field].label.toLowerCase()),_item.find(".ui-edit-btn").show().click(function(){var tr=$(this).closest("tr");tr.addClass("ui-edit-mode");var saveBtn=$(this).closest("tr").find(".ui-save-btn"),editBtn=$(this).closest("tr").find(".ui-edit-btn"),cancelBtn=$(this).closest("tr").find(".ui-cancel-btn"),txtarea=$(this).closest("tr").find("textarea");txtarea.removeAttr("readonly"),saveBtn.show(),cancelBtn.show(),editBtn.hide(),txtarea.hasClass("ui-pointer")&&txtarea.removeClass("ui-pointer").addClass("-ui-pointer"),txtarea.hasClass("ui-clickable-link")&&txtarea.removeClass("ui-clickable-link").addClass("-ui-clickable-link")}),_item.find(".ui-cancel-btn").hide().click(function(){var tr=$(this).closest("tr");tr.removeClass("ui-edit-mode");var saveBtn=$(this).closest("tr").find(".ui-save-btn"),editBtn=$(this).closest("tr").find(".ui-edit-btn"),cancelBtn=$(this).closest("tr").find(".ui-cancel-btn"),txtarea=$(this).closest("tr").find("textarea");txtarea.val(txtarea.attr("data-prev-value")),txtarea.attr("readonly","readonly"),saveBtn.hide(),cancelBtn.hide(),editBtn.show(),txtarea.hasClass("-ui-pointer")&&txtarea.removeClass("-ui-pointer").addClass("ui-pointer"),txtarea.hasClass("-ui-clickable-link")&&txtarea.removeClass("-ui-clickable-link").addClass("ui-clickable-link")}),_item.find(".ui-save-btn").hide().click(function(){var tr=$(this).closest("tr");tr.removeClass("ui-edit-mode"),tr.find(".ui-save-btn").hide(),tr.find(".ui-edit-btn").hide(),tr.find(".ui-cancel-btn").hide();var fname=tr.find(".control-label").attr("data-field-name"),body={},value=tr.find("textarea").val()||null;body[fname]=value;var spinner=tr.find(".ui-spinner-value").show();spinner.html($PluginUtils.createSpinner()),tr.find("textarea").attr("readonly","readonly"),$client.updateSobject(id,describe.name,body,function(err,rslt){return tr.find(".ui-spinner-value").html(""),tr.find("textarea").removeAttr("readonly"),err?(tr.find(".ui-save-btn").show(),tr.find(".ui-edit-btn").hide(),tr.find(".ui-cancel-btn").show(),void tr.find(".ui-spinner-value").html('<br/><span class="text-danger">'+(err.length&&err[0].errorCode?err[0].message:err)+"</span>")):(tr.find("textarea").attr("data-prev-value",value),void tr.find(".ui-cancel-btn").trigger("click"))})}),"reference"===describe.fields[field].type){var textarea=_item.find("textarea.ui-field-value");textarea.addClass("ui-clickable-link"),textarea.addClass("ui-pointer"),textarea.attr("title","Click to query..."),textarea.click(function(){$(this).prop("readonly")&&$(this).val()&&(_inputId.val($(this).val()),_btnRefresh.click())})}var value=null===data[field]||void 0===data[field]?"":data[field];if("object"!=typeof value){var textarea=_item.find("textarea");describe.fields[field].length&&textarea.attr("maxlength",describe.fields[field].length),textarea.val(value).attr("data-prev-value",value),_formContainer.append(_item)}}_results.html("").append(_downloadLinks).append(_formContainer),_saveAllButton.unbind("click").click(function(){var body={};_results.find("tr.ui-edit-mode ").each(function(){var fname=$(this).find(".control-label").attr("data-field-name"),value=$(this).find("textarea").val()||null;$(this).find("textarea").attr("readonly","readonly");var spinner=$(this).find(".ui-spinner-value").show();spinner.html($PluginUtils.createSpinner()),$(this).find("textarea").attr("readonly","readonly"),body[fname]=value}),debug.log("Updaging object: ",body),$client.updateSobject(id,describe.name,body,function(err,rslt){_results.find("tr.ui-edit-mode ").each(function(){if($(this).find(".ui-spinner-value").html(""),$(this).find("textarea").removeAttr("readonly"),err)return $(this).find(".ui-save-btn").show(),$(this).find(".ui-edit-btn").hide(),$(this).find(".ui-cancel-btn").show(),void $(this).find(".ui-spinner-value").html('<br/><span class="text-danger">'+(err.length&&err[0].errorCode?err[0].message:err)+"</span>");var value=$(this).find("textarea").val()||null;$(this).find("textarea").attr("data-prev-value",value),$(this).find(".ui-cancel-btn").trigger("click")})})}),sendAnalyticsEvent($C.Analytics.EVENTS.QUICKCONSOLE_ACTION.Actions.TAB_GET_SOBJECT_FIELDS.name)})):handleWarning("Invalid Sobject ID ["+id+"]")},getSFIdFromURL=function(isLEX){if($PluginUtils.checkIfSobjectPage(isLEX))return $PluginUtils.getSFIdFromUrl(window.location.href,isLEX);var pid=PopupUtils.getURLParameter("id");return PopupUtils.isSalesforceId(pid)?pid:null};return{title:"Sobject fields",id:$C.Plugins.$SFORG_PLUGIN_00001,type:"TAB",manifestVersion:"1.0",description:"...","wiki-url":"http://www.wwww.com",create:function(options,tabState){return _isLex=options.isLEX,_orgId=options.orgId,$client=new $SalesforceClient.Client(options.serverUrl,options.sessionId,options.apiLevel),_inputId.val(getSFIdFromURL(options.isLEX)),refreshPluginHistory(),_container},onFocus:function(){var id=getSFIdFromURL(_isLex);id&&_inputId.val(id)},onBlur:function(){},mainAction:function(params,_devConsole,tabIndex){var id=getSFIdFromURL(_isLex);_inputId.val(id),id&&_btnRefresh.click(),_devConsole.isVisible()?_devConsole.openTab(tabIndex):(_devConsole.toggle(),setTimeout(function(){_devConsole.openTab(tabIndex)},500))}}}(),$SFORG_PLUGIN_00002=function(){function handleWarning(msg){_results.html($PluginUtils.createError(msg))}function handleLoading(msg){msg=msg||"Loading results...",_results.html($PluginUtils.createSpinner(msg))}var $client,TEXTAREA_FULL_HEIGHT=180,TEXTAREA_SMALL_HEIGHT=55,_useToolingAPI=!1,_queryAllRows=!1,_queryTextarea=$('<textarea style="width:100%;"/>'),_btnQuery=$('<button class="btn btn-default btn-block btn-sm">Execute</button>'),_btnQuerySmall=$('<button class="btn btn-default btn-block btn-xs">Execute</button>'),btnQueryHandler=function(){sendAnalyticsEvent($C.Analytics.EVENTS.QUICKCONSOLE_ACTION.Actions.TAB_QUICK_QUERY.name),_results.show("fast"),_subqueryContainer.hide("fast"),query(_editor.getValue())};_btnQuery.click(btnQueryHandler),_btnQuerySmall.click(btnQueryHandler).hide();var toolbarToggler=$('<small style="cursor:pointer;">toggle toolbar</small>');toolbarToggler.click(function(){toggleToolbar(!_headerContainer.find(".ui-second-header").is(":visible"))});var _selectQueryHistory=$('<select class="form-control input-sm ui-soql-history-slct" style="height: 25px; font-size: 8pt;" />');_selectQueryHistory.on("change",function(){_editor.setValue(_selectQueryHistory.val())});var _toolingBtn=$('<button type="button" class="btn btn-xs btn-block btn-default" style="font-size: 6pt; font-weight:bold">TOOLING</button>');_toolingBtn.on("click",function(){_useToolingAPI=!_useToolingAPI,_useToolingAPI?(_toolingBtn.removeClass("btn-disabled").addClass("active").addClass("btn-warning"),_queryAllRowsCmp.hide()):(_toolingBtn.removeClass("active").removeClass("btn-warning").addClass("btn-disabled"),_queryAllRowsCmp.show())});var _queryAllRowsCmp=$('<div><span class="ui-pointer fa fa-square-o ui-checkbox" data-flag="false"></span>&nbsp;<label>Query all rows</label></input></div>');_queryAllRowsCmp.find("span.ui-checkbox").click(function(){var qarFlag="true"===$(this).attr("data-flag");qarFlag?($(this).addClass("fa-square-o").removeClass("fa-check-square-o"),$(this).attr("data-flag","false")):($(this).removeClass("fa-square-o").addClass("fa-check-square-o"),$(this).attr("data-flag","true")),_queryAllRows=!qarFlag});var _headerContainer=$('<div class="well well-small ui-plugin-container"><div class="row ui-top-header" ><div class="col-xs-8 ui-left-header"></div><div class="col-xs-2 ui-center-header"></div><div class="col-xs-2 ui-right-header"></div></div><div class="row ui-second-header" ><div class="col-xs-1 ui-left-header"></div><div class="col-xs-9 ui-center-header"></div><div class="col-xs-2 ui-right-header"></div></div><hr style="margin:5px;" /><div class="row ui-middle-header"><div class="col-xs-12 ui-left-header"></div></div><hr style="margin:10px;" /><div class="row ui-bottom-header"><div class="col-xs-1 ui-left-header"></div><div class="col-xs-3 ui-center-header"></div><div class="col-xs-2 ui-center2-header"></div><div class="col-xs-5 ui-right-header"></div><div class="col-xs-1 ui-right2-header"></div></div></div>');_headerContainer.find(".ui-top-header .ui-left-header").append('<h4>Quick Query <small class="text-muted">Execute SOQL, SOSL or Tooling API queries.</small></h4>'),_headerContainer.find(".ui-top-header .ui-center-header").append(toolbarToggler),_headerContainer.find(".ui-top-header .ui-right-header").append(_btnQuerySmall),_headerContainer.find(".ui-second-header .ui-right-header").append(_btnQuery).append(_toolingBtn),_headerContainer.find(".ui-middle-header .ui-left-header").append(_queryTextarea).append('<div class="ui-textarea-footer text-muted text-right" style="font-family:monospace; width: 100%">Line: <span class="ui-cm-line"></span> Column: <span class="ui-cm-column"></span></div>'),_headerContainer.find(".ui-second-header .ui-left-header").append('<small style="margin-left:10px" class="text-muted">History</small>'),_headerContainer.find(".ui-second-header .ui-center-header").append(_selectQueryHistory).append(_queryAllRowsCmp);var _container=$("<div />");_container.append(_headerContainer);var _results=$('<div class="ui-results-container"/>');_container.append(_results);var _subqueryContainer=$('<div class="ui-subquery-container"/>').hide();_container.append(_subqueryContainer);var viqLabel=$('<small class="text-muted" style="margin-left: 10px;"></small>').html("V.I.Q.").attr("title","Very Important Query - Select a query or save current query with a name");_headerContainer.find(".ui-bottom-header .ui-left-header").append(viqLabel);var _VIQNameTxt=$('<input type="text" maxLength="150" class="form-control input-sm" style="height: 25px;"/>').attr("placeholder","V.I.Q. name"),_btnVIQSave=$('<div style="display: inline !important;" class="btn btn-default btn-sm "><span class="fa fa-floppy-o"></span></div>').attr("title","Save current query"),_btnVIQClear=$('<div style="display: inline !important;" class="btn btn-default btn-sm "><span class="fa fa-ban" ></span></div>').attr("title","Reset VIQ editing"),_btnGroup=$('<div class="btn-group btn-group-justified" style="padding: 4px"></div>').append(_btnVIQSave).append(_btnVIQClear),_viqErrorMsg=$('<small class="text-danger" />');_headerContainer.find(".ui-bottom-header .ui-center-header").append(_VIQNameTxt).append(_viqErrorMsg),_headerContainer.find(".ui-bottom-header .ui-center2-header").append(_btnGroup);var _viqQuerySlct=$('<select class="form-control input-sm ui-viq-slct" style="height: 25px; font-size: 8pt;" />');_headerContainer.find(".ui-bottom-header .ui-right-header").append(_viqQuerySlct);var _deleteVIQbtn=$('<button class="btn btn-default btn-sm"><span class="fa fa-trash" title="Delete V.I.Q."></span></button>');_headerContainer.find(".ui-bottom-header .ui-right2-header").append(_deleteVIQbtn),_deleteVIQbtn.click(function(){_viqQuerySlct.val()&&PopupUtils.getGlobalPluginStorage($SFORG_PLUGIN_00002.id,function(err,data){var _storage=data||{};_storage.queries=_storage.queries||[];for(var i=0;i<_storage.queries.length;i++)if(_viqQuerySlct.val()==_storage.queries[i].id){_storage.queries.splice(i,1);break}PopupUtils.setGlobalPluginStorage($SFORG_PLUGIN_00002.id,_storage,function(err,ph){PopupUtils.syncData({noQuotaCheck:!0},function(err){err&&PopupUtils.logError(err),refreshVIQs()})})})}),_viqQuerySlct.on("change",function(){if(_viqErrorMsg.html(""),!_viqQuerySlct.val())return _viqErrorMsg.val(""),_VIQNameTxt.attr("data-viq-id",null),void _VIQNameTxt.val("");for(var query=null,i=0;i<_pluginVIQs.queries.length;i++)if(_viqQuerySlct.val()==_pluginVIQs.queries[i].id){query=_pluginVIQs.queries[i];break}_VIQNameTxt.val(query.name),_VIQNameTxt.attr("data-viq-id",query.id),_editor.setValue(query.body)}),_btnVIQClear.click(function(){_VIQNameTxt.attr("data-viq-id",null),_VIQNameTxt.val(""),_viqQuerySlct.val(""),_viqErrorMsg.val("")}),_btnVIQSave.click(function(){_viqErrorMsg.html("");var id=_VIQNameTxt.attr("data-viq-id"),name=_VIQNameTxt.val(),body=_editor.getValue();return name&&body?void PopupUtils.getGlobalPluginStorage($SFORG_PLUGIN_00002.id,function(err,data){var _storage=data||{};_storage.queries=_storage.queries||[];var query=null;if(id)for(var i=0;i<_storage.queries.length;i++)if(id==_storage.queries[i].id){query=_storage.queries[i];break}query||(query={id:$PluginUtils.getUniqueId(),createdDate:(new Date).getTime()},_storage.queries.push(query)),query.name=name,query.body=body,query.lastModifiedDate=(new Date).getTime(),_storage.queries.sort(function(a,b){return a.name?b.name&&a.name<=b.name?-1:1:-1}),PopupUtils.setGlobalPluginStorage($SFORG_PLUGIN_00002.id,_storage,function(err,ph){PopupUtils.syncData({noQuotaCheck:!0},function(err){err&&PopupUtils.logError(err),refreshVIQs(function(){_viqQuerySlct.val(query.id),_viqQuerySlct.trigger("change")})})})}):void _viqErrorMsg.html("Invalid name and/or query content.");
});var _editor,toggleToolbar=function(show){show?(_container.find(".CodeMirror").height(TEXTAREA_FULL_HEIGHT),_container.find(".ui-second-header").show("fast"),_container.find(".ui-bottom-header").show("fast"),_btnQuerySmall.hide("fast")):(_container.find(".CodeMirror").height(TEXTAREA_SMALL_HEIGHT),_container.find(".ui-second-header").hide("fast"),_container.find(".ui-bottom-header").hide("fast"),_btnQuerySmall.show("fast"))},query=function(queryBody){handleLoading();var isSOQL=queryBody.trim().toLowerCase().indexOf("select")>=0,callbackQuery=function(err,data){if(err)return handleWarning(err),void _results.closest(".modal-body").animate({scrollTop:_results.offset().top-110},1e3);for(var i=_pluginHistory.queries.length-1;i>=0;i--){var query=_pluginHistory.queries[i];query.body===queryBody&&_pluginHistory.queries.splice(i,1)}_pluginHistory.queries.push({body:queryBody,lastModifiedDate:(new Date).getTime()}),_pluginHistory.queries.length>50&&_pluginHistory.queries.splice(0,_pluginHistory.queries.length-50),PopupUtils.setPluginStorage($SFORG_PLUGIN_00002.id,_orgId,_pluginHistory,function(err,ph){refreshPluginHistory()});var _subqueries={},recursiveFieldCheck=function(keySet,prefix,obj){var isSubquery=!1;for(var key in obj)if(obj.hasOwnProperty(key))if(obj[key]&&"records"===key){isSubquery=!0;var totSizeKey=(prefix?prefix+".":"")+"totalSize",doneKey=(prefix?prefix+".":"")+"done";_subqueries[prefix]||(_subqueries[prefix]=[]);var tsIndex=keySet.indexOf(totSizeKey);tsIndex>=0&&keySet.splice(tsIndex,1);var dIndex=keySet.indexOf(doneKey);dIndex>=0&&keySet.splice(dIndex,1);for(var ci=0;ci<obj.records.length;ci++)recursiveFieldCheck(_subqueries[prefix],null,obj.records[ci])}else if(obj[key]&&"object"==typeof obj[key])"attributes"!==key&&"object"==typeof obj[key]&&recursiveFieldCheck(keySet,(prefix?prefix+".":"")+key,obj[key]);else{if(isSubquery&&("done"===key||"totalSize"===key))continue;var realKey=(prefix?prefix+".":"")+key;keySet.indexOf(realKey)<0&&keySet.push(realKey)}};if(!isSOQL&&data.searchRecords&&(data=data.searchRecords),_results.html(""),!data||!data.length)return void _results.html("No result found");var ALTERNATE_BACKGROUND_COLOR="#e8f0ff",_tmpColor=ALTERNATE_BACKGROUND_COLOR,drawTable=function(data){function createColumn(key){return{data:key,render:function(data,type,row){if(_subqueries[key])return'<span class="ui-subquery-result-cell" style="cursor:pointer;"><span class="fa fa-binoculars ui-discover-icon">&nbsp;</span> <span>'+(data?data.totalSize:0)+"</span></span>";if(data&&("Id"===key||PopupUtils.isSalesforceId(data))){var link=$('<a target="_blank"></a>').attr("href","/"+data);return link.text(data),link.get(0).outerHTML}if(!data&&0!==data&&data!==!1)return null;var el=$("<span/>");return el.text(data),el.get(0).outerHTML},createdCell:function(td,cellData,rowData,row,col){if(_subqueries[key]&&cellData){if(!cellData||!cellData.totalSize)return;$(td).find(".ui-subquery-result-cell").on("click",function(){var table=$('<div>Download results (<small class="ui-download-results-json-child" style="cursor:pointer;">json</small> | <small class="ui-download-results-csv-child" style="cursor:pointer;">csv</small>)<table class="table table-hover table-condensed" style="width:100%, height:100%"><thead><tr/></thead><tbody/></table></div>'),trHead=table.find("tr"),columns=_subqueries[key],colProps=[];for(var i in columns)trHead.append($("<th/>").html(columns[i])),colProps.push(createColumn(columns[i]));var title=$('<h3 class="ui-query-result-title">'+key+' <small style="cursor:pointer;">back</small></h3>');title.find("small").click(function(){_results.show("fast"),_subqueryContainer.hide("fast")}),_subqueryContainer.html("").append(title).append(table),table.find("table").DataTable({autoWidth:!1,data:cellData.records,columns:colProps,order:[]}),table.css("height","98%");for(var i=1;i<12;i++)table.find(".col-sm-"+i).removeClass("col-sm-"+i).addClass("col-xs-"+i);table.find(".ui-download-results-json-child").click(function(){PopupUtils.triggerDownloadTextFileFromBackground("query"+_orgId+"_"+(new Date).getTime()+".json","text/json",JSON.stringify(cellData.records,null,2),!1)}),table.find(".ui-download-results-csv-child").click(function(){for(var csvRows=[],firstRow=[],c=0;c<colProps.length;c++)firstRow.push(colProps[c].data);csvRows.push('"'+firstRow.join('","')+'"');for(var i=0;i<cellData.records.length;i++){for(var row=[],c=0;c<colProps.length;c++){var val=$PluginUtils.getDescendantProp(cellData.records[i],colProps[c].data);val=null===val||"undefined"==typeof val?"":"object"==typeof val&&val.records?val.records.length:(""+val).replace('"','""'),row.push(val)}csvRows.push('"'+row.join('","')+'"')}var csv=csvRows.join("\n");PopupUtils.triggerDownloadTextFileFromBackground("query"+_orgId+"_"+(new Date).getTime()+".csv","text/csv",csv,!1)}),_results.hide("fast"),_subqueryContainer.show("fast")})}}}}_tmpColor="transparent"===_tmpColor?ALTERNATE_BACKGROUND_COLOR:"transparent";for(var _keys=[],i=0;i<data.length;i++)recursiveFieldCheck(_keys,null,data[i]);for(var ki=_keys.length-1;ki>=0;ki--)for(var obji=_keys[ki],kj=0;kj<_keys.length;kj++)if(ki!==kj){var objj=_keys[kj];if(!(obji.indexOf(".")>0)&&objj.indexOf(".")>0&&0==objj.indexOf(obji)){_keys.splice(ki,1);break}}for(var _columns=[],i=0;i<data.length;i++){for(var obj=data[i],ki=0;ki<_keys.length;ki++){var key=_keys[ki];if(!_subqueries[key]&&key.indexOf(".")>=0){for(var tmp=obj,splt=key.split("."),ti=0;ti<splt.length-1;ti++)tmp[splt[ti]]||(tmp[splt[ti]]={}),tmp=tmp[splt[ti]];tmp[splt[splt.length-1]]||(tmp[splt[splt.length-1]]=null)}}for(var sqkey in _subqueries)if(obj[sqkey]){var objList=obj[sqkey].records;if(objList)for(var oi=0;oi<objList.length;oi++)for(var objChild=objList[oi],ki=0;ki<_subqueries[sqkey].length;ki++){var key=_subqueries[sqkey][ki];if(key.indexOf(".")>=0){for(var tmp=objChild,splt=key.split("."),ti=0;ti<splt.length-1;ti++)tmp[splt[ti]]||(tmp[splt[ti]]={}),tmp=tmp[splt[ti]];tmp[splt[splt.length-1]]||(tmp[splt[splt.length-1]]=null)}}}}for(var i in _keys)_columns.push(createColumn(_keys[i]));for(var key in _subqueries)_keys.indexOf(key)<0&&_columns.push(createColumn(key));var table=$('<div style="padding:5px; background-color:'+_tmpColor+'"><h3 class="ui-query-result-title">'+obj.attributes.type+'</h3><div>Download results (<small class="ui-download-results-json" style="cursor:pointer;">json</small> | <small class="ui-download-results-csv" style="cursor:pointer;">csv</small>)<table class="table table-hover table-condensed" style="width:100%, height:100%"><thead><tr/></thead><tbody/></table></div></div>');table.find(".ui-download-results-json").click(function(){PopupUtils.triggerDownloadTextFileFromBackground("query"+_orgId+"_"+(new Date).getTime()+".json","text/json",JSON.stringify(data,null,2),!1)}),table.find(".ui-download-results-csv").click(function(){for(var csvRows=[],firstRow=[],c=0;c<_columns.length;c++)firstRow.push(_columns[c].data);csvRows.push('"'+firstRow.join('","')+'"');for(var i=0;i<data.length;i++){for(var row=[],c=0;c<_columns.length;c++){var val=$PluginUtils.getDescendantProp(data[i],_columns[c].data);val=null===val||"undefined"==typeof val?"":"object"==typeof val&&val.records?val.records.length:(""+val).replace('"','""'),row.push(val)}csvRows.push('"'+row.join('","')+'"')}var csv=csvRows.join("\n");PopupUtils.triggerDownloadTextFileFromBackground("query"+_orgId+"_"+(new Date).getTime()+".csv","text/csv",csv,!1)});var trHead=table.find("tr");for(var i in _keys)trHead.append($("<th/>").html(_keys[i]));for(var key in _subqueries)_keys.indexOf(key)<0&&trHead.append($("<th/>").html(key));_results.append(table),table.find("table").DataTable({autoWidth:!1,data:data,columns:_columns,order:[]}),table.css("width","98%"),table.css("height","98%");for(var i=1;i<12;i++)table.find(".col-sm-"+i).removeClass("col-sm-"+i).addClass("col-xs-"+i)};if(isSOQL)drawTable(data);else{for(var dataChunks={},i=0;i<data.length;i++){var tmpD=dataChunks[data[i].attributes.type];tmpD||(tmpD=[],dataChunks[data[i].attributes.type]=tmpD),tmpD.push(data[i])}for(var key in dataChunks)dataChunks.hasOwnProperty(key)&&drawTable(dataChunks[key])}_results.closest(".modal-body").animate({scrollTop:_results.offset().top-110},1e3)};isSOQL?(console.log("_queryAllRows",_queryAllRows),$client.query(_useToolingAPI,queryBody||"",callbackQuery,_queryAllRows)):$client.search(queryBody||"",callbackQuery)},_pluginHistory={queries:[{body:"Select Id, Name, Profile.Name From User Limit 10",lastModifiedDate:(new Date).getTime()}]},refreshPluginHistory=function(){PopupUtils.getPluginStorage($SFORG_PLUGIN_00002.id,_orgId,function(err,data){data&&data.queries&&data.queries.length&&(_pluginHistory=data),_queryTextarea.val(_pluginHistory.queries[_pluginHistory.queries.length-1].body),_selectQueryHistory.html("");for(var i=_pluginHistory.queries.length-1;i>=0;i--){var opt=$("<option />");opt.attr("title","Last executed: "+new Date(_pluginHistory.queries[i].lastModifiedDate).toISOString().replace("T"," ").split(".")[0]+"\n"+_pluginHistory.queries[i].body),opt.attr("value",_pluginHistory.queries[i].body),opt.html($("<span/>").text(_pluginHistory.queries[i].body.substring(0,100)+(_pluginHistory.queries[i].body.length>100?"...":"")).html()),_selectQueryHistory.append(opt)}})},_pluginVIQs={queries:[]},refreshVIQs=function(callback){PopupUtils.getGlobalPluginStorage($SFORG_PLUGIN_00002.id,function(err,data){_pluginVIQs=data&&data.queries&&data.queries.length?data:{queries:[]},_viqQuerySlct.html("");var optSel=$('<option value="">-- Select a V.I.Q. --</option>');_viqQuerySlct.append(optSel);for(var i=0;i<_pluginVIQs.queries.length;i++){var opt=$("<option />"),lastDate=_pluginVIQs.queries[i].lastModifiedDate||_pluginVIQs.queries[i].createdDate;lastDate&&(lastDate="["+new Date(lastDate).toISOString().replace("T"," ").split(".")[0]+"]"),opt.attr("title",_pluginVIQs.queries[i].body.substring(0,100)+(_pluginVIQs.queries[i].body.length>100?"...":"")),opt.attr("value",_pluginVIQs.queries[i].id),opt.html($("<span/>").text(_pluginVIQs.queries[i].name+" "+lastDate).html()),_viqQuerySlct.append(opt)}return callback&&callback()})},_orgId=null,_shortcuts=null,_darkMode=!1,_myDomain=null;return{title:"Quick Query",id:$C.Plugins.$SFORG_PLUGIN_00002,type:"TAB",manifestVersion:"1.0",description:"...","wiki-url":"http://www.wwww.com",create:function(options,tabState){return $client=new $SalesforceClient.Client(options.serverUrl,options.sessionId,options.apiLevel),_orgId=options.orgId,_shortcuts=options.shortcuts,_darkMode=options.darkMode,_myDomain=options.myDomain,refreshPluginHistory(),refreshVIQs(),_container},onFocus:function(){if(!_editor){_editor=CodeMirror.fromTextArea(_queryTextarea.get(0),{mode:"text/x-sql",indentWithTabs:!0,smartIndent:!0,lineNumbers:!0,matchBrackets:!0,autofocus:!0,indentUnit:4,tabSize:1,theme:_darkMode?"darcula":"default"}),_editor.setOption("extraKeys",{Tab:function(cm){var spaces=Array(cm.getOption("indentUnit")+1).join(" ");cm.replaceSelection(spaces)},"Ctrl-I":function(cm){for(var i=0;i<cm.lineCount();i++)cm.indentLine(i)}});var updateCursorCoordinates=function(editor){$(".ui-textarea-footer .ui-cm-column").html(editor.getCursor().ch+1),$(".ui-textarea-footer .ui-cm-line").html(editor.getCursor().line+1)};_editor.on("cursorActivity",function(editor){return updateCursorCoordinates(editor)}),updateCursorCoordinates(_editor),$(_editor.getWrapperElement()).resizable({handles:"s, n",resize:function(){_editor.setSize($(this).width(),$(this).height()),_editor.refresh()}}),_container.find(".CodeMirror").height(TEXTAREA_FULL_HEIGHT),$client.globalDescribe(function(err,rslt){if(err)throw err;var describeMap={};for(var key in rslt)rslt[key].queryable&&(describeMap[key]=rslt[key]);var extraKeys=_editor.getOption("extraKeys"),autocompleteShortcut="Ctrl-Space";_shortcuts&&_shortcuts.sc9&&(autocompleteShortcut=PopupUtils.shortcutToString(_shortcuts.sc9,!1,"-"),autocompleteShortcut=autocompleteShortcut.replace("Control","Ctrl").replace("Command","Cmd")),extraKeys[autocompleteShortcut]="autocomplete",CodeMirror.normalizeKeyMap(extraKeys),_editor.setOption("extraKeys",extraKeys),_editor.setOption("hintOptions",{_describe:describeMap,_sfclient:$client,completeSingle:!1,hint:CodeMirror.hint["soql-hint"]})})}},onBlur:function(){}}}(),$SFORG_PLUGIN_00003=function(){function handleWarning(msg){_results.html($PluginUtils.createError(msg))}function handleLoading(msg){msg=msg||"Loading results...",_results.html($PluginUtils.createSpinner(msg))}var $client,TEXTAREA_FULL_HEIGHT=200,TEXTAREA_SMALL_HEIGHT=75,_queryTextarea=$('<textarea style="width:100%"></textarea>'),_btnQuery=$('<button class="btn btn-default btn-block btn-sm">Execute</button>'),_btnQuerySmall=$('<button class="btn btn-default btn-block btn-xs">Execute</button>'),executeHandler=function(){sendAnalyticsEvent($C.Analytics.EVENTS.QUICKCONSOLE_ACTION.Actions.TAB_EXECUTE_ANON.name),execute(_editor.getValue())};_btnQuery.click(executeHandler),_btnQuerySmall.click(executeHandler).hide();var _debugCategories={},slctBase="<select><option>NONE</option><option>ERROR</option><option>WARN</option><option>INFO</option><option selected>DEBUG</option><option>FINE</option><option>FINER</option><option>FINEST</option></select>",categories=["All","Db","Workflow","Validation","Callout","Apex_code","Apex_profiling","Visualforce","System"],slctList=[];for(var catIndex in categories){var catName=categories[catIndex];"All"!==catName&&(_debugCategories[catName]="DEBUG");var slct=$(slctBase).attr("data-category",catName),container=$('<div style="display:inline-block; margin: 10px; text-align:center" />');container.append($("<label>"+catName+"</label>")).append($("<br/>")).append(slct),slctList.push(container),slct.on("click",function(){var dataCat=$(this).attr("data-category"),val=$(this).val();if("All"===dataCat)for(var ci in categories){var cname=categories[ci];"All"!==cname&&($('[data-category="'+cname+'"]').val(val),_debugCategories[cname]=val)}else _debugCategories[dataCat]=val})}var _container=$("<div />"),_headerContainer=$('<div class="well well-small ui-plugin-container"><div class="row ui-top-header" ><div class="col-xs-8 ui-left-header"></div><div class="col-xs-2 ui-center-header"></div><div class="col-xs-2 ui-right-header"></div></div><div class="row ui-top-sub-header text-center"><div class="col-xs-12 ui-center-header"></div></div><div class="row ui-second-header" ><div class="col-xs-1 ui-left-header"></div><div class="col-xs-9 ui-center-header"></div><div class="col-xs-2 ui-right-header"></div></div><hr style="margin:10px" /><div class="row ui-middle-header"><div class="col-xs-12 ui-left-header"></div></div><hr style="margin:10px" /><div class="row ui-bottom-header"><div class="col-xs-1 ui-left-header"></div><div class="col-xs-3 ui-center-header"></div><div class="col-xs-2 ui-center2-header"></div><div class="col-xs-5 ui-right-header"></div><div class="col-xs-1 ui-right2-header"></div></div></div>');_headerContainer.find(".ui-top-header .ui-left-header").append('<h4>Execute Anonymous <small class="text-muted">Execute Apex code.</small></h4>');var toolbarToggler=$('<small style="cursor:pointer;">toggle toolbar</small>');toolbarToggler.click(function(){toggleToolbar(!_headerContainer.find(".ui-top-sub-header").is(":visible"))}),_headerContainer.find(".ui-top-header .ui-center-header").append(toolbarToggler),_headerContainer.find(".ui-top-header .ui-right-header").append(_btnQuerySmall),_headerContainer.find(".ui-middle-header .ui-left-header").append(_queryTextarea).append('<div class="ui-textarea-footer text-muted text-right" style="font-family:monospace; width: 100%">Line: <span class="ui-cm-line"></span> Column: <span class="ui-cm-column"></span></div>'),_headerContainer.find(".ui-second-header .ui-right-header").append(_btnQuery),_headerContainer.find(".ui-top-sub-header .ui-center-header").append(slctList);var _selectQueryHistory=$('<select class="form-control input-sm ui-execute-history" style="height: 25px; font-size: 8pt;" />');_selectQueryHistory.on("change",function(){_editor.setValue(_headerContainer.find(".ui-execute-history").val())}),_headerContainer.find(".ui-second-header .ui-left-header").append('<small style="margin-left:10px" class="text-muted">History</small>'),_headerContainer.find(".ui-second-header .ui-center-header").append(_selectQueryHistory);var viqLabel=$('<small class="text-muted" style="margin-left: 10px;"></small>').html("V.I.S.").attr("title","Very Important Scripts - Select a script or save current script with a name");_headerContainer.find(".ui-bottom-header .ui-left-header").append(viqLabel);var _VISNameTxt=$('<input type="text" maxLength="150" class="form-control input-sm" style="height: 25px;"/>').attr("placeholder","V.I.S. name"),_btnVIQSave=$('<div style="display: inline !important;" class="btn btn-default btn-sm "><span class="fa fa-floppy-o" ></span></div>').attr("title","Save current script"),_btnVIQClear=$('<div style="display: inline !important;" class="btn btn-default btn-sm "><span class="fa fa-ban" ></span></div>').attr("title","Reset VIQ editing"),_btnGroup=$('<div class="btn-group btn-group-justified" style="padding: 4px"></div>').append(_btnVIQSave).append(_btnVIQClear),_visErrorMsg=$('<small class="text-danger" />');_headerContainer.find(".ui-bottom-header .ui-center-header").append(_VISNameTxt).append(_visErrorMsg),_headerContainer.find(".ui-bottom-header .ui-center2-header").append(_btnGroup);var _visQuerySlct=$('<select class="form-control input-sm ui-viq-slct" style="height: 25px; font-size: 8pt;" />');_headerContainer.find(".ui-bottom-header .ui-right-header").append(_visQuerySlct);var _deleteVISbtn=$('<button class="btn btn-default btn-sm"><span class="fa fa-trash" title="Delete V.I.S."></span></button>');_headerContainer.find(".ui-bottom-header .ui-right2-header").append(_deleteVISbtn),_deleteVISbtn.click(function(){_visQuerySlct.val()&&PopupUtils.getGlobalPluginStorage($SFORG_PLUGIN_00003.id,function(err,data){var _storage=data||{};_storage.queries=_storage.scripts||[];for(var i=0;i<_storage.scripts.length;i++)if(_visQuerySlct.val()==_storage.scripts[i].id){_storage.scripts.splice(i,1);break}PopupUtils.setGlobalPluginStorage($SFORG_PLUGIN_00003.id,_storage,function(err,ph){PopupUtils.syncData({noQuotaCheck:!0},function(err){err&&PopupUtils.logError(err),refreshVISs()})})})}),_visQuerySlct.on("change",function(){if(_visErrorMsg.html(""),!_visQuerySlct.val())return _visErrorMsg.val(""),_VISNameTxt.attr("data-vis-id",null),void _VISNameTxt.val("");for(var query=null,i=0;i<_pluginVISs.scripts.length;i++)if(_visQuerySlct.val()==_pluginVISs.scripts[i].id){query=_pluginVISs.scripts[i];break}_VISNameTxt.val(query.name),_VISNameTxt.attr("data-vis-id",query.id),_editor.setValue(query.body)}),_btnVIQClear.click(function(){_VISNameTxt.attr("data-vis-id",null),_VISNameTxt.val(""),_visQuerySlct.val(""),_visErrorMsg.val("")}),_btnVIQSave.click(function(){_visErrorMsg.html("");var id=_VISNameTxt.attr("data-vis-id"),name=_VISNameTxt.val(),body=_editor.getValue();return name&&body?void PopupUtils.getGlobalPluginStorage($SFORG_PLUGIN_00003.id,function(err,data){var _storage=data||{};_storage.scripts=_storage.scripts||[];var query=null;if(id)for(var i=0;i<_storage.scripts.length;i++)if(id==_storage.scripts[i].id){query=_storage.scripts[i];break}query||(query={id:$PluginUtils.getUniqueId(),createdDate:(new Date).getTime()},_storage.scripts.push(query)),query.name=name,query.body=body,query.lastModifiedDate=(new Date).getTime(),_storage.scripts.sort(function(a,b){return a.name?b.name&&a.name<=b.name?-1:1:-1}),PopupUtils.setGlobalPluginStorage($SFORG_PLUGIN_00003.id,_storage,function(err,ph){PopupUtils.syncData({noQuotaCheck:!0},function(err){err&&PopupUtils.logError(err),refreshVISs(function(){_visQuerySlct.val(query.id),_visQuerySlct.trigger("change")})})})}):void _visErrorMsg.html("Invalid name and/or script content.")}),_container.append(_headerContainer);var _results=$("<div />");_container.append(_results);var _editor,toggleToolbar=function(show){show?(_container.find(".CodeMirror").height(TEXTAREA_FULL_HEIGHT),$(".ui-top-sub-header").show("fast"),$(".ui-bottom-header").show("fast"),$(".ui-second-header").show("fast"),_btnQuerySmall.hide("fast")):(_container.find(".CodeMirror").height(TEXTAREA_SMALL_HEIGHT),$(".ui-top-sub-header").hide("fast"),$(".ui-bottom-header").hide("fast"),$(".ui-second-header").hide("fast"),_btnQuerySmall.show("fast"))},execute=function(apexcode){handleLoading(),$client.executeAnonymous(apexcode,_debugCategories,function(err,resp){if(err)return handleWarning(err),void _results.closest(".modal-body").animate({scrollTop:_results.offset().top-110},1e3);for(var i=_pluginHistory.executions.length-1;i>=0;i--){var query=_pluginHistory.executions[i];query.body===apexcode&&_pluginHistory.executions.splice(i,1)}_pluginHistory.executions.push({body:apexcode,lastModifiedDate:(new Date).getTime()}),_pluginHistory.executions.length>50&&_pluginHistory.executions.splice(0,_pluginHistory.executions.length-50),PopupUtils.setPluginStorage($SFORG_PLUGIN_00003.id,_orgId,_pluginHistory,function(err,ph){refreshPluginHistory()});var now=(new Date).getTime(),objContent=$('<div class="alert alert-danger" role="alert"><pre style="color:red;"></pre></div>');objContent.find("pre").text(JSON.stringify(resp.result,null,2));var logPanel=$('<div><small class="ui-download-log-link" style="cursor:pointer;">Download log</small><pre style="width:100%">'+(resp.debugLog.length>1e4?resp.debugLog.substring(0,9997)+'<br/><a class="ui-download-log-link" style="cursor:pointer;"> <b>. . .</b> </a>':resp.debugLog)+"</pre></div>");_results.html(""),"true"!==resp.result.success&&_results.append(objContent),resp.debugLog&&(_results.append(logPanel),logPanel.find(".ui-download-log-link").on("click",function(){PopupUtils.triggerDownloadTextFileFromBackground("log_"+_orgId+"_"+now+".log","text/log",unescape(encodeURIComponent(resp.debugLog)))})),_results.closest(".modal-body").animate({scrollTop:_results.offset().top-110},1e3)})},refreshPluginHistory=function(){PopupUtils.getPluginStorage($SFORG_PLUGIN_00003.id,_orgId,function(err,data){data&&data.executions&&data.executions.length&&(_pluginHistory=data),_queryTextarea.val(_pluginHistory.executions[_pluginHistory.executions.length-1].body),_selectQueryHistory.html("");for(var i=_pluginHistory.executions.length-1;i>=0;i--){var opt=$("<option/>");opt.attr("title","Last executed: "+new Date(_pluginHistory.executions[i].lastModifiedDate).toUTCString()+"\n"+_pluginHistory.executions[i].body),opt.attr("value",_pluginHistory.executions[i].body),opt.html($("<span/>").text(_pluginHistory.executions[i].body.substring(0,100)+(_pluginHistory.executions[i].body.length>100?"...":"")).html()),_selectQueryHistory.append(opt)}})},_pluginHistory={executions:[{body:"System.debug('Hello World!');",lastModifiedDate:(new Date).getTime()}]},_pluginVISs={scripts:[]},refreshVISs=function(callback){PopupUtils.getGlobalPluginStorage($SFORG_PLUGIN_00003.id,function(err,data){_pluginVISs=data&&data.scripts&&data.scripts.length?data:{scripts:[]},_visQuerySlct.html("");var optSel=$('<option value="">-- Select a V.I.S. --</option>');_visQuerySlct.append(optSel);for(var i=0;i<_pluginVISs.scripts.length;i++){var opt=$("<option />"),lastDate=_pluginVISs.scripts[i].lastModifiedDate||_pluginVISs.scripts[i].createdDate;lastDate&&(lastDate="["+new Date(lastDate).toISOString().replace("T"," ").split(".")[0]+"]"),opt.attr("title",_pluginVISs.scripts[i].body.substring(0,100)+(_pluginVISs.scripts[i].body.length>100?"...":"")),opt.attr("value",_pluginVISs.scripts[i].id),opt.html($("<span/>").text(_pluginVISs.scripts[i].name+" "+lastDate).html()),_visQuerySlct.append(opt)}return callback&&callback()})},_orgId=null,_darkMode=!1,_myDomain=null;return{title:"Execute Anonymous",id:$C.Plugins.$SFORG_PLUGIN_00003,type:"TAB",manifestVersion:"1.0",description:"...","wiki-url":"http://www.wwww.com",create:function(options,tabState){return $client=new $SalesforceClient.Client(options.serverUrl,options.sessionId,options.apiLevel),_orgId=options.orgId,_darkMode=options.darkMode,_myDomain=options.myDomain,refreshPluginHistory(),refreshVISs(),_container},onFocus:function(){if(!_editor){_editor=CodeMirror.fromTextArea(_queryTextarea.get(0),{mode:"text/x-java",indentWithTabs:!0,smartIndent:!0,lineNumbers:!0,matchBrackets:!0,autofocus:!0,indentUnit:4,tabSize:1,theme:_darkMode?"darcula":"default"}),_editor.setOption("extraKeys",{Tab:function(cm){var spaces=Array(cm.getOption("indentUnit")+1).join(" ");cm.replaceSelection(spaces)},"Ctrl-I":function(cm){for(var i=0;i<cm.lineCount();i++)cm.indentLine(i)}});var updateCursorCoordinates=function(editor){$(".ui-textarea-footer .ui-cm-column").html(editor.getCursor().ch+1),$(".ui-textarea-footer .ui-cm-line").html(editor.getCursor().line+1)};_editor.on("cursorActivity",function(editor){return updateCursorCoordinates(editor)}),updateCursorCoordinates(_editor),$(_editor.getWrapperElement()).resizable({handles:"s, n",resize:function(){_editor.setSize($(this).width(),$(this).height()),_editor.refresh()}}),toggleToolbar(!0)}},onBlur:function(){}}}(),$SFORG_PLUGIN_00004=function(){var _inputId=$('<textarea class="form-control" rows="15" placeholder="15 Digit ID" ></textarea>'),_convertedIdSpan=$('<textarea class="form-control" rows="15" placeholder="18 Digit ID" readonly="readonly"></textarea>');_inputId.on("keyup",function(){for(var ids=_inputId.val().split("\n"),idsOutput="",i=0;i<ids.length;i++){var convertedId=$PluginUtils.convertId(ids[i]);idsOutput+=(convertedId||"")+"\n"}_convertedIdSpan.val(idsOutput)});var _container=$("<div />"),_headerContainer=$('<div class="well well-small ui-plugin-container"><div class="ui-top-header" /><div class="row"><div class="col-xs-6 text-center"><LABEL>15 char ID</LABEL></div><div class="col-xs-6 text-center"><ABEL>18 char ID</ABEL></div></div><div class="row"><div class="col-xs-6 ui-left-header text-center"></div><div class="col-xs-6 ui-right-header text-center"></div></div></div>');_container.append(_headerContainer),_headerContainer.find(".ui-top-header").append('<h4>Convert SF Id <small class="text-muted">Convert 15 char Salesforce ID to 18 char.</small></h4>'),_headerContainer.find(".ui-left-header").append(_inputId),_headerContainer.find(".ui-right-header").append(_convertedIdSpan);var _results=$("<div />");_container.append(_results);var getSFIdFromURL=function(isLEX){if($PluginUtils.checkIfSobjectPage(isLEX))return $PluginUtils.getSFIdFromUrl(window.location.href,isLEX);var pid=PopupUtils.getURLParameter("id");return PopupUtils.isSalesforceId(pid)?pid:null};return{title:"Convert SF Id",id:$C.Plugins.$SFORG_PLUGIN_00004,type:"TAB",manifestVersion:"1.0",description:"...","wiki-url":"http://www.wwww.com",create:function(options,tabState){return _container},onFocus:function(){_inputId.focus();var currentValue=_inputId.val();_inputId.val(""),document.execCommand("paste");var newValue=_inputId.val();newValue&&$PluginUtils.isSalesforceId(newValue)?_inputId.trigger("keyup"):_inputId.val(currentValue),_inputId.focus()},onBlur:function(){},mainAction:function(params,_devConsole,tabIndex){PopupUtils.copyToClipboard(getSFIdFromURL(params.isLEX))}}}(),$SFORG_PLUGIN_00005=function(){function handleWarning(msg){_statusMessages.html($PluginUtils.createError(msg))}function handleLoading(msg){msg=msg||"Loading results...",_statusMessages.html($PluginUtils.createSpinner(msg))}var $client,_btnDescribe=$('<button class="btn btn-default btn-sm btn-block">Describe!</button>');_btnDescribe.click(function(){sendAnalyticsEvent($C.Analytics.EVENTS.QUICKCONSOLE_ACTION.Actions.TAB_EXECUTE_DESCRIBE.name),describeAll()});var _btnBack=$('<button class="btn btn-default btn-sm btn-block">Back</button>');_btnBack.click(function(){_objDescribeDiv.show(),_fieldsDescribDiv.html("").hide(),_btnBack.hide(),_btnDescribe.show(),_inputSearch.val(""),_inputSearch.trigger("keyup")}).hide();var _inputSearch=$('<input type="text" class="form-control input-sm " placeholder="Filter..." />');_inputSearch.on("keyup",function(){filterFields($(this).val())});var _container=$("<div />"),_headerContainer=$('<div class="well well-small ui-plugin-container"><div class="ui-top-header" /><div class="row"><div class="col-xs-4 ui-left-header"></div><div class="col-xs-4 ui-center-header"></div><div class="col-xs-4 ui-right-header"></div></div></div>');_container.append(_headerContainer),_headerContainer.find(".ui-top-header").append('<h4>Quick ORG Describe <small class="text-muted">Describe objects and fields.</small></h4>'),_headerContainer.find(".ui-center-header").append(_btnDescribe).append(_btnBack),_headerContainer.find(".ui-right-header").append(_inputSearch);var _fieldsDescribDiv=$('<div class="ui-obj-describe table-responsive" />').hide(),_objDescribeDiv=$("<div />"),_statusMessages=$('<div class="text-muted text-center" style="width:100%"/>');_container.append(_statusMessages),_container.append(_objDescribeDiv),_container.append(_fieldsDescribDiv),_inputSearch.hide();var filterFields=function(filter){filter=(filter||"").toLowerCase();var trClass=".ui-describe-object-row",container=_objDescribeDiv;return _fieldsDescribDiv.is(":visible")&&(trClass=".ui-describe-field-row",container=_fieldsDescribDiv),filter?void container.find(trClass).each(function(){var tr=$(this);tr.attr("data-field-name").indexOf(filter)<0&&tr.attr("data-field-label").indexOf(filter)<0&&(tr.attr("data-field-keyprefix")||"").indexOf(filter)<0?(tr.hide(),tr.next().hasClass("ui-describe-field-subrow")&&tr.next().hide()):tr.show()}):void container.find("tr"+trClass).show()},describeAll=function(){handleLoading("Loading describe..."),_objDescribeDiv.show().html(""),_fieldsDescribDiv.html("").hide(),_inputSearch.hide(),$client.globalDescribe(function(err,data){if(err)return handleWarning(err);_inputSearch.show();var _formContainer=$('<table class="table table-hover table-condensed"><thead><tr><th>API Name</th><th>Label</th><th>Key Prefix</th><th/><th/></thread><tbody/></table>');_statusMessages.html(""),_objDescribeDiv.append(_formContainer);var compileObjects=function(obj){var _item=$('<tr class="ui-describe-object-row"><td><label >'+key+"</label></td><td><label >"+obj.label+"</label></td><td><label >"+(obj.keyPrefix||"")+'</label></td><td><button class="btn btn-sm btn-block btn-default ui-btn-describe-object">Describe</button><div class="ui-describe-log" /></td></tr>');_item.attr("data-field-name",key.toLowerCase()).attr("data-field-label",obj.label.toLowerCase()),obj.keyPrefix&&_item.attr("data-field-keyprefix",obj.keyPrefix.toLowerCase()),_formContainer.find("tbody").append(_item),_item.find("button.ui-btn-describe-object").on("click",function(){var rslt=_item.find(".ui-describe-log");rslt.html($PluginUtils.createSpinner("Describing...")),_inputSearch.val(""),sendAnalyticsEvent($C.Analytics.EVENTS.QUICKCONSOLE_ACTION.Actions.TAB_GET_SOBJECT_FIELDS.name),$client.describeObjectByKeyOrName(null,obj.name,!0,function(err,data){function selectField(fieldName,isSelected){if(isSelected){if(selectedFields.indexOf(fieldName)>=0)return;selectedFields.push(fieldName)}else selectedFields.indexOf(fieldName)>=0&&selectedFields.splice(selectedFields.indexOf(fieldName),1)}function buildQuery(){var query="Select ";selectedFields.length>0?(query+=selectedFields.join(", "),query+=" From "+obj.name):query="",_fieldsDescribDiv.find(".ui-query-builder").val(query)}function compileField(field){var _fitem=$('<tr class="ui-describe-field-row"><td><input class="ui-slct-field" type="checkbox" /></td><td><label >'+field.name+"</label></td><td><label >"+field.label+"</label></td><td><label >"+field.type+'</label></td><td><span class="ui-field-details" style="cursor:pointer; text-decoration: underline;">toggle details</span></tr>');_fitem.find(".ui-field-details").on("click",function(){var containingTr=$(this).closest("tr").next();containingTr.is(":visible")!==!0&&jsonViewerDiv.html("").jJsonViewer(field),containingTr.toggle("fast")}),_fitem.find(".ui-slct-field").on("click",function(){
var isSelected=$(this).is(":checked");selectField(field.name,isSelected),buildQuery()});var _subfitem=$('<tr class="ui-describe-field-subrow"><td colspan="1"/><td class="ui-json-view" colspan="3" /></tr>').hide();tBody.append(_fitem).append(_subfitem);var jsonViewerDiv=$('<div style="overflow:auto; max-height:200px"/>');_subfitem.find("td.ui-json-view").append(jsonViewerDiv),_fitem.attr("data-field-name",field.name.toLowerCase()).attr("data-field-name-wc",field.name).attr("data-field-label",field.label.toLowerCase())}if(err)return rslt.html("Unexpected error (2) ["+err+"]");rslt.html("");var table=$('<table class="table table-hover table-condensed"><thead><tr/></thead><tbody/></table>'),dataArray=[];for(var key in data.fields)if(data.fields.hasOwnProperty(key)){var field=data.fields[key];dataArray.push(field)}dataArray.sort(function(x,y){return x.name.toLowerCase()<y.name.toLowerCase()?-1:x.name.toLowerCase()>y.name.toLowerCase()?1:0});var selectedFields=[],trHead=table.find("tr");trHead.append('<th><input class="ui-slct-all-fields" type="checkbox" /></th><th>API Name</th><th>Label</th><th>Type</th><th/>');var tBody=table.find("tbody");trHead.find(".ui-slct-all-fields").click(function(){var isSelected=$(this).is(":checked");tBody.find(".ui-slct-field").each(function(){$(this).prop("checked",isSelected);var fieldName=$(this).closest("tr").attr("data-field-name-wc");selectField(fieldName,isSelected)}),buildQuery()});for(var di=0;di<dataArray.length;di++)compileField(dataArray[di]);_objDescribeDiv.hide(),_btnBack.show(),_btnDescribe.hide();var objTitle=$('<div><div class="row"><div class="col-xs-4"><h4>'+obj.name+' <small class="ui-obj-details" style="cursor:pointer; text-decoration: underline;">details</small></h4> <h5>('+obj.label+')</h5></div><div class="col-xs-8"> <small class="text-muted">Double click to copy to clipboard</small><textarea class="input-sm ui-query-builder" readonly="readonly" placeholder="Select fields to build a query..."/></div></div>');objTitle.find("textarea").attr("title","Double click to copy to clipboard...").on("dblclick",function(){PopupUtils.copyToClipboard($(this).val())});var jsonViewerDiv=$('<div style="overflow:auto; max-height:200px"/>').hide();objTitle.append(jsonViewerDiv);var viewerOrb=JSON.parse(JSON.stringify(obj));delete viewerOrb.fields,delete viewerOrb._describeLastCallDate,jsonViewerDiv.jJsonViewer(viewerOrb),objTitle.find(".ui-obj-details").on("click",function(){jsonViewerDiv.toggle("fast")});var _downloadLinks=$('<div>Download data ( <small class="ui-download-describe-json" style="cursor:pointer;">json</small> | <small class="ui-download-describe-csv" style="cursor:pointer;">csv</small> )</div>');_downloadLinks.find(".ui-download-describe-json").click(function(){PopupUtils.triggerDownloadTextFileFromBackground(obj.name+"_"+(new Date).getTime()+".json","text/json",JSON.stringify(data.fields,null,2),!1)}),_downloadLinks.find(".ui-download-describe-csv").click(function(){var csv="",columns=[];for(var key in data.fields)if(data.fields.hasOwnProperty(key))for(var descrKey in data.fields[key])data.fields[key].hasOwnProperty(descrKey)&&(columns.indexOf(descrKey)>=0||columns.push(descrKey));var csvRows=['"'+columns.join('","')+'"'];for(var key in data.fields)if(data.fields.hasOwnProperty(key)){for(var field=data.fields[key],row=[],di=0;di<columns.length;di++){var descrKey=columns[di],val=field[descrKey];null===val||"undefined"==typeof val?val="":Array.isArray(val)?val=JSON.stringify(val):"object"==typeof val&&(val=JSON.stringify(val)),val=(""+val).replace(/"/gi,""),row.push(val)}csvRows.push('"'+row.join('","')+'"')}var csv=csvRows.join("\n");PopupUtils.triggerDownloadTextFileFromBackground(obj.name+"_"+(new Date).getTime()+".csv","text/csv",csv,!1)}),_fieldsDescribDiv.show().html("").append(objTitle).append(_downloadLinks).append(table)})})};for(var key in data){var obj=data[key];compileObjects(obj)}})};return{title:"Quick ORG Describe",id:$C.Plugins.$SFORG_PLUGIN_00005,type:"TAB",manifestVersion:"1.0",description:"...","wiki-url":"http://www.wwww.com",create:function(options,tabState){return $client=new $SalesforceClient.Client(options.serverUrl,options.sessionId,options.apiLevel),_container},onFocus:function(){},onBlur:function(){}}}(),$SFORG_PLUGIN_00006=function(){function handleWarning(msg){_results.html($PluginUtils.createError(msg))}var $client,_isLex=!1,_btnReplace=$('<button class="btn btn-default btn-sm " title="Click to replace fields API names">Replace!</button>');_btnReplace.click(function(){replaceFields(window.location.href)});var _container=$("<div />"),_headerContainer=$('<div class="well well-small ui-plugin-container"><div class="ui-top-header" /><div class="row"><div class="col-xs-4 ui-left-header"></div><div class="col-xs-4 ui-center-header"></div><div class="col-xs-4 ui-right-header"></div></div></div>');_container.append(_headerContainer),_headerContainer.find(".ui-top-header").append('<h4>Replace API Names <small class="text-muted">Replace all field labels with their API name (available only on Salesforce&copy; Classic and LEX standard page layouts, Field Sets editor and Page Layout editor page).</small></h4><br/> <small>* For Field Sets editor and Page Layout editor, if the object has a lot of fields, revert to label view  before executing any update on the layouts (otherwise tab may freeze for a while).'),_headerContainer.find(".ui-right-header").append(_btnReplace);var _results=$("<div />");_container.append(_results),!$PluginUtils.checkIfSobjectPage()&&!window.location.href.indexOf("setup/FieldSetEditor.apexp")>0&&!window.location.href.indexOf("layouteditor/layoutEditor.apexp")>0&&!window.location.href.indexOf("p/mfpkg/AddToPackageFromChangeMgmtUi")>0&&(_btnReplace.attr("disabled",!0),_btnReplace.attr("title","Current page is not a standard Sobject layout"));var _isNotReplaced=!0,id="",pageType="",_fieldsDescribe=null,_objectDescribe=null,describeFields=function(id,isRefresh){$client.describeObjectByKeyOrName(id.substring(0,3),null,!1,function(err,objDescr){_objectDescribe=objDescr,$client.getAllFieldsId(id.substring(0,3),null,function(err,data){return err?handleWarning("<b>Unexpected error (1) ["+err+"]</b>"):(_fieldsDescribe=data,executeReplaceInDOM(isRefresh))})})},executeReplaceInDOM=function(isRefresh){if(isRefresh||(_isNotReplaced=!_isNotReplaced),_btnReplace.attr("disabled",!1),_fieldsDescribe.done&&_fieldsDescribe.records&&_fieldsDescribe.records.length){"SOBJECT_DETAIL"==pageType&&(_isLex?$("p.entityNameTitle").text(_isNotReplaced?_objectDescribe.label:_objectDescribe.name).attr("title",_isNotReplaced?_objectDescribe.name:_objectDescribe.label):$("div.bPageBlock td.pbTitle h2.mainTitle, h1.pageType").first().text(_isNotReplaced?_objectDescribe.label+" Detail":_objectDescribe.name).attr("title",_isNotReplaced?_objectDescribe.name:_objectDescribe.label));for(var mainPanel=_isLex?$("div.forceDetailPanelDesktop").first():$("div.bPageBlock").first(),i=0;i<_fieldsDescribe.records.length;i++){var field=_fieldsDescribe.records[i];if("OUTBOUND_CS_EDITOR"==pageType){_isNotReplaced||(field.Label=$('a[href="/'+field.Id.substring(0,15)+'"]').html());var ns=field.NamespacePrefix?field.NamespacePrefix+"__":"";$('a[href="/'+field.Id.substring(0,15)+'"]').html(_isNotReplaced?field.Label:field.ObjectQualifiedName+".<b>"+ns+field.DeveloperName+"__c</b>").attr("title",_isNotReplaced?field.ObjectQualifiedName+"."+ns+field.DeveloperName+"__c":field.Label).css("text-decoration","none")}else{var durableId=(field.DurableId||".").split(".")[1];if(!durableId)continue;"SOBJECT_DETAIL"==pageType?_isLex?mainPanel.find("div.slds-form-element span.slds-form-element__label").filter(function(){return $(this).text().trim()===(_isNotReplaced?field.QualifiedApiName:field.Label)}).text(_isNotReplaced?field.Label:field.QualifiedApiName).attr("title",_isNotReplaced?field.QualifiedApiName:field.Label):mainPanel.find("tr td.labelCol, tr td.labelCol span").filter(function(){return $(this).text().trim()===(_isNotReplaced?field.QualifiedApiName:field.Label)||$($(this)[0].childNodes[0]).text()===(_isNotReplaced?field.QualifiedApiName:field.Label)}).text(_isNotReplaced?field.Label:field.QualifiedApiName).attr("title",_isNotReplaced?field.QualifiedApiName:field.Label):"FIELDSET_EDITOR"==pageType?$('[id="'+durableId+'"] .label,[id="fieldsetItem_'+durableId+'"] .field-name').html(_isNotReplaced?field.Label:field.QualifiedApiName).attr("title",_isNotReplaced?field.QualifiedApiName:field.Label):"LAYOUT_EDITOR"==pageType&&($('[id="'+durableId+'"] .label,[id="fieldsetItem_'+durableId+'"] .field-name').html(_isNotReplaced?field.Label:field.QualifiedApiName).attr("title",_isNotReplaced?field.QualifiedApiName:field.Label),$('[id="item_'+durableId+'"] .itemLabel .labelText').html(_isNotReplaced?field.Label:field.QualifiedApiName).attr("title",_isNotReplaced?field.QualifiedApiName:field.Label))}}}isRefresh||(_isNotReplaced?_btnReplace.html("Replace!"):_btnReplace.html("Revert!"))},replaceFields=function(url){function bindDomChange(){id&&pageType&&!_isNotReplaced&&($(".layoutEdit, .FieldSetPage").unbind("DOMSubtreeModified"),executeReplaceInDOM(!0),$(".layoutEdit, .FieldSetPage").on("DOMSubtreeModified",bindDomChange))}if(!pageType||_isLex){if(url=url||"",!url)return handleWarning("Invalid Sobject URL (1)");if(url.indexOf("setup/FieldSetEditor.apexp")>0){var tableEnumOrId=PopupUtils.getURLParameter("tableEnumOrId");pageType="FIELDSET_EDITOR",$client.getObjectToolingDetails(tableEnumOrId,function(err,rslt){return!err&&rslt&&rslt.length?(id=rslt[0].KeyPrefix,void describeFields(id)):handleWarning("Something went wrong getting object info.")})}else if(url.indexOf("p/mfpkg/AddToPackageFromChangeMgmtUi")>0){var entityType=$("#entityType").val();if(pageType="OUTBOUND_CS_EDITOR","CustomFieldDefinition"===entityType){var fieldIds=[];$(".listRelatedObject table.list tr.dataRow th a").each(function(){fieldIds.push($(this).attr("href").replace("/",""))}),$client.getAllFieldsById(fieldIds,function(err,data){if(err)return handleWarning("<b>Unexpected error (1) ["+err+"]</b>");_fieldsDescribe=data;for(var objectsId=[],i=0;i<_fieldsDescribe.records.length;i++)objectsId.push(_fieldsDescribe.records[i].TableEnumOrId);$client.getObjectsByTableEnumOrId(objectsId,function(err,data){if(err)return handleWarning("<b>Unexpected error (2) ["+err+"]</b>");for(var objMap={},j=0;j<data.records.length;j++)objMap[data.records[j].DurableId]=data.records[j].QualifiedApiName;for(var i=0;i<_fieldsDescribe.records.length;i++){var field=_fieldsDescribe.records[i];field.ObjectQualifiedName=objMap[field.TableEnumOrId.substring(0,15)]||field.TableEnumOrId}executeReplaceInDOM(!1)})})}}else if(url.indexOf("layouteditor/layoutEditor.apexp")>0){var tableEnumOrId=PopupUtils.getURLParameter("type");pageType="LAYOUT_EDITOR",$client.getObjectToolingDetails(tableEnumOrId,function(err,rslt){return!err&&rslt&&rslt.length?(id=rslt[0].KeyPrefix,void describeFields(id)):handleWarning("Something went wrong getting object info.")})}else{if(pageType="SOBJECT_DETAIL",id=PopupUtils.getSFIdFromUrl(url,_isLex),debug.log(id,url,_isLex),!$PluginUtils.isSalesforceId(id))return pageType=null,handleWarning("Invalid Sobject URL (2)");$client.getUIAPIForRecord(id,function(err,result){function cursorForward(section){layoutRowItemIndex+1>=section.layoutRows[layoutRowIndex].layoutItems.length?(layoutRowItemIndex=0,layoutRowIndex++):layoutRowItemIndex++,layoutRowIndex>=section.layoutRows.length&&(layoutRowIndex=0,sectionIndex++)}debug.log("#### REPLACE 2.0",err,result),id=$PluginUtils.convertId(id);var apiName=result.records[id].apiName,objectLabel=result.objectInfos[apiName].label,recordTypeId=Object.keys(result.layouts[apiName])[0];debug.log("apiName",apiName,"recordTypeId",recordTypeId);var layoutInfo=result.layouts[apiName][recordTypeId].Full.View;debug.log("layoutInfo",layoutInfo);var sectionIndex=0,layoutRowIndex=0,layoutRowItemIndex=0;if(_isLex){var objectLabelSpan=$(".entityNameTitle:visible");objectLabelSpan.html(objectLabel+' (<span class="ui-organizer-link">'+apiName+"</span>)")}else $("#_objectLbl").length||$('<div id="_objectLbl" class="ui-organizer-link">'+objectLabel+" ("+apiName+")</div>").insertAfter($(".topName,.efhpTitle"));$(_isLex?"div.record-layout-container:visible":"table.detailList").each(function(sindex){$(this).find(_isLex?".slds-form__item:visible":"td.dataCol[colspan=2],td.data2Col[colspan=4],td.labelCol").each(function(findex){if(!(sectionIndex>=layoutInfo.sections.length)){var section=layoutInfo.sections[sectionIndex],rowItem=section.layoutRows[layoutRowIndex].layoutItems[layoutRowItemIndex].layoutComponents[0];if("Field"===rowItem.componentType){var labelElement=_isLex?$(this).find(".test-id__field-label-container:visible"):$(this),label=labelElement.attr("data-org-label");if(!_isLex&&labelElement.find("span.helpButton").length&&(label=labelElement.find("span.helpButton")[0].firstChild.nodeValue),label||(label=labelElement.text()),labelElement.attr("data-org-label",label),debug.log(sindex,findex,"label",label),!_isLex)for(var skippedExceptions=!1;!skippedExceptions;)if(skippedExceptions=!0,"CurrencyIsoCode"===rowItem.apiName){if(cursorForward(section),sectionIndex>=layoutInfo.sections.length)return;if(section=layoutInfo.sections[sectionIndex],rowItem=section.layoutRows[layoutRowIndex].layoutItems[layoutRowItemIndex].layoutComponents[0],"Opportunity"===apiName)return;for(;"EmptySpace"===rowItem.componentType;){if(cursorForward(section),sectionIndex>=layoutInfo.sections.length)return;section=layoutInfo.sections[sectionIndex],rowItem=section.layoutRows[layoutRowIndex].layoutItems[layoutRowItemIndex].layoutComponents[0]}}else if("Case"===apiName&&("SuppliedEmail"===rowItem.apiName&&!(result.records[id].fields.SuppliedEmail||{}).value||"SuppliedCompany"===rowItem.apiName&&!(result.records[id].fields.SuppliedCompany||{}).value||"SuppliedPhone"===rowItem.apiName&&!(result.records[id].fields.SuppliedPhone||{}).value||"SuppliedName"===rowItem.apiName&&!(result.records[id].fields.SuppliedName||{}).value)){if(cursorForward(section),sectionIndex>=layoutInfo.sections.length)return;skippedExceptions=!1,section=layoutInfo.sections[sectionIndex],rowItem=section.layoutRows[layoutRowIndex].layoutItems[layoutRowItemIndex].layoutComponents[0]}if("Field"!==rowItem.componentType)return void cursorForward(section);debug.log(label+" vs "+rowItem.label,rowItem);var fieldDescr=result.objectInfos[apiName].fields[rowItem.apiName]||{};_isLex?labelElement.find("span").html(label+' (<span class="ui-organizer-link">'+rowItem.apiName+"</span>)"):labelElement.find("span.helpButton").length?labelElement.find("span._fldApi").length||$('<span class="_fldApi"> (<span class="ui-organizer-link">'+rowItem.apiName+"</span>)</span>").insertBefore(labelElement.find("span.helpButton img")):labelElement.html(label+' (<span class="ui-organizer-link">'+rowItem.apiName+"</span>)");var dataTypeInfo="Data Type: "+fieldDescr.dataType;"Reference"===fieldDescr.dataType&&(dataTypeInfo+=" ("+fieldDescr.referenceToInfos.map(function(item){return item.apiName}).join(",")+")"),labelElement.attr("title",dataTypeInfo).addClass("ui-pointer")}cursorForward(section)}})}),_btnReplace.attr("disabled",!1).text("Replace"),pageType=null})}_btnReplace.html("Loading...").attr("disabled",!0),"FIELDSET_EDITOR"!=pageType&&"LAYOUT_EDITOR"!=pageType||$(".layoutEdit, .FieldSetPage").on("DOMSubtreeModified",bindDomChange)}else executeReplaceInDOM(!1)};return{title:"Replace API Names",id:$C.Plugins.$SFORG_PLUGIN_00006,type:"TAB",manifestVersion:"1.0",description:"...","wiki-url":"http://www.wwww.com",create:function(options,tabState){return _isLex=options.isLEX,$client=new $SalesforceClient.Client(options.serverUrl,options.sessionId,options.apiLevel),_container},onFocus:function(){},onBlur:function(){},mainAction:function(params){return replaceFields(window.location.href)}}}(),$SFORG_PLUGIN_00007=function(){var _container=$("<div />").addClass("container").css("width","100%").css("height","100%").css("background-color","black"),linkDiv=$("<div/>").addClass("text-center");_container.append(linkDiv);var gameDiv=$("<div/>").css("width","100%").addClass("text-center");_container.append(gameDiv);var sfinvloaded=!1,sfInvadersLink=$('<a href="#"/>').html("<strong>Cloud Invaders</strong>").addClass("text-warning").click(function(){gameDiv.html("");var canvas=$("<canvas/>").addClass("ui-game-space-invader").attr("width",640).attr("height",640),help=$('<center><small style="color:white;">X to shoot</small></center>');return gameDiv.append(canvas).append(help),sfinvloaded&&SpaceInvaders.resetAll(),SpaceInvaders.init(canvas[0],_container[0]),SpaceInvaders.animate(),sfinvloaded=!0,!1}),tetrisLink=$('<a href="#"/>').html("<strong>Cloud Blocks</strong>").addClass("text-warning").click(function(){gameDiv.html("");var canvas=$("<div/>").addClass("ui-game-tetris");gameDiv.append(canvas);var help=$('<div style="display:inline"></div>');return gameDiv.append(help),canvas.blockrain({theme:"retro",autoBlockWidth:!1,autoBlockSize:10,blockWidth:12,onNext:function(next){}}),!1});return linkDiv.append(sfInvadersLink),linkDiv.append('<span class="text-warning"> | </span>'),linkDiv.append(tetrisLink),{title:"Games",id:$C.Plugins.$SFORG_PLUGIN_00007,type:"TAB",manifestVersion:"1.0",description:"...","wiki-url":"http://www.wwww.com",create:function(options,tabState){return _container},onFocus:function(){sfInvadersLink[0].click()},onBlur:function(){}}}(),$SFORG_PLUGIN_00008=function(){function handleWarning(msg){_statusMessages.html($PluginUtils.createError(msg))}function handleLoading(msg){msg=msg||"Loading results...",_statusMessages.html($PluginUtils.createSpinner(msg))}var $client,_oid,_sid,_incognitoSupported,_siteDomain,_btnSearch=$('<button class="btn btn-default btn-sm btn-block">Search</button>');_btnSearch.click(function(){searchUsers()});var _inputSearch=$('<input type="text" class="form-control input-sm " placeholder="Search users..." />');_inputSearch.on("keyup",function(){$(this).val().length>2?_btnSearch.removeAttr("disabled"):_btnSearch.attr("disabled",!0)});var _container=$("<div />"),_headerContainer=$('<div class="well well-small ui-plugin-container"><div class="ui-top-header" /><div class="row"><div class="col-xs-4 ui-left-header"></div><div class="col-xs-4 ui-center-header"></div><div class="col-xs-4 ui-right-header"></div></div></div>');_container.append(_headerContainer),_headerContainer.find(".ui-top-header").append('<h4>Login As... <small class="text-muted">Search internal users and login as them.</small></h4>'),_headerContainer.find(".ui-right-header").append(_btnSearch),_headerContainer.find(".ui-center-header").append(_inputSearch);var _usrSrcDiv=$('<div class="ui-user-result table-responsive" />').hide(),_statusMessages=$('<div class="text-muted text-center" style="width:100%"/>');_container.append(_statusMessages),_container.append(_usrSrcDiv);var searchUsers=function(){handleLoading("Loading describe..."),_usrSrcDiv.show().html(""),_usrSrcDiv.html("").hide(),_btnSearch.attr("disabled",!0),$client.search("FIND {"+_inputSearch.val().replace(/\{/g,"\\{").replace(/\}/g,"\\}").replace(/'/g,"\\'")+"} IN ALL FIELDS RETURNING User(Id, Name, Profile.Name, ProfileId, UserRoleId, UserRole.Name, Email, Username Where ContactId = null and IsActive = true and UserType != 'Guest' ORDER BY Name, Username, Email)",function(err,data){if(err)return handleWarning(err);if(_btnSearch.removeAttr("disabled"),_usrSrcDiv.html("").show(),!data||!data.searchRecords||!data.searchRecords.length)return handleWarning("No user found.");var _formContainer=$('<table class="table table-hover table-condensed"><thead><tr><th/><th/><th/><th>Id</th><th>Full Name</th><th>Username</th><th>Email</th><th>Profile Name</th><th>Role</th><th/></thread><tbody/></table>');_statusMessages.html(""),_usrSrcDiv.append(_formContainer);for(var compileRows=function(user){var _item=$('<tr class="ui-user-row"><td><button class="btn btn-sm btn-block btn-default ui-btn-jump-to" title="Details..."><span class="fa fa-eye" ></span> </button></td><td><button class="btn btn-sm btn-block btn-success ui-btn-login-as" title="Login As..."><span class="fa fa-folder-open-o" ></span> </button></td><td><button class="btn btn-sm btn-block btn-danger ui-btn-login-as-incognito" title="Login As... (Incognito Mode)"><span class="fa fa-user-secret" ></span> </button></td><td><label id="t-uid"></label></td><td><label id="t-uname"></label></td><td><label id="t-uusname"></label></td><td><label id="t-uemail"></label></td><td><div id="t-uprofile" class="t-uprofile"></div></td><td><label id="t-urole"></label></td></tr>');_item.find("#t-uid").text(user.Id),_item.find("#t-uname").text(user.Name),_item.find("#t-uusname").text(user.Username),_item.find("#t-uemail").text(user.Email),_item.find("#t-uprofile").append($("<span/>").text(user.Profile.Name).click(function(){window.open("/"+user.ProfileId)})),_item.find("#t-urole").text((user.UserRole||{}).Name);var loginAsUrl="/servlet/servlet.su?oid="+_oid+"&suorgadminid="+user.Id+"&targetURL="+encodeURIComponent(PopupUtils.StandardLandingPages[2])+"&retURL="+encodeURIComponent("/lightning/setup/ManageUsers/page?address="+encodeURIComponent("/"+user.Id+"?noredirect=1&isUserEntityOverride=1&targetURL="+PopupUtils.StandardLandingPages[2]));return _item.find(".ui-btn-jump-to").click(function(){window.open("/"+user.Id+"?noredirect=1&isUserEntityOverride=1")}),_item.find(".ui-btn-login-as").click(function(){window.open(loginAsUrl)}),_incognitoSupported?_item.find(".ui-btn-login-as-incognito").click(function(){if(_incognitoSupported){var url="https://"+_siteDomain+"/secur/frontdoor.jsp?sid="+_sid+"&retURL="+encodeURIComponent(loginAsUrl);chrome.runtime.sendMessage({action:"BKG-OPEN-INCOGNITO-LINK",url:url})}}):_item.find(".ui-btn-login-as-incognito").attr("disabled",!0).attr("title",chrome.i18n.getMessage("popup_enable_incognito_mode")),_item},i=0;i<data.searchRecords.length;i++)_usrSrcDiv.find("tbody").append(compileRows(data.searchRecords[i]));sendAnalyticsEvent($C.Analytics.EVENTS.QUICKCONSOLE_ACTION.Actions.TAB_LOGIN_AS_SEARCH.name)})};return{title:"Login As...",id:$C.Plugins.$SFORG_PLUGIN_00008,type:"TAB",manifestVersion:"1.0",description:"...","wiki-url":"http://www.wwww.com",create:function(options,tabState){return _oid=options.orgId,_sid=options.sessionId,_incognitoSupported=options.incognitoSupported,_siteDomain=options.siteDomain,$client=new $SalesforceClient.Client(options.serverUrl,options.sessionId,options.apiLevel),_container},onFocus:function(){_inputSearch.focus()},onBlur:function(){}}}();return{$PluginUtils:$PluginUtils,$SFORG_PLUGIN_00000:$SFORG_PLUGIN_00000,$SFORG_PLUGIN_00001:$SFORG_PLUGIN_00001,$SFORG_PLUGIN_00002:$SFORG_PLUGIN_00002,$SFORG_PLUGIN_00003:$SFORG_PLUGIN_00003,$SFORG_PLUGIN_00004:$SFORG_PLUGIN_00004,$SFORG_PLUGIN_00005:$SFORG_PLUGIN_00005,$SFORG_PLUGIN_00006:$SFORG_PLUGIN_00006,$SFORG_PLUGIN_00007:$SFORG_PLUGIN_00007,$SFORG_PLUGIN_00008:$SFORG_PLUGIN_00008}}),global.true=exports}({},function(){return this}());