/* ORGanizer for Salesforce - v10000.0.9.53 
 * Author: Enrico Murru (https://organizer.solutions/)
 * Copyright 2016-2024
 */
!function(exports,global){require(["global","constants","jquery","popup-utils","change-set","change-set-v2","grootanizer","formula-editor","checkbox-utils","field-history","organizer-apis","code-coverage","whitelist-all-ips","jquery-ui"],function($G,$C,$,PopupUtils,ChangeSetHelper,ChangeSetHelperV2,Grootanizer,FormulaEditor,CheckboxUtils,FieldHistoryUtils,$ExtAPI,$CodeCoverage,$IPWhitelistPlugin){"use sctrict";function inIframe(){try{return window.self!==window.top}catch(e){return!0}}var _oid,_serverName,_sid,_domain,_domainAPI,_tabColor,_tabTitle,_betaFeatures,_formulaApplied,_apiLevel,chrome=$G.chrome,window=$G.window,IS_LEX=PopupUtils.isLEX(),debug=PopupUtils.newDebugger("ORGanizer: Iframe-ContentScript"),_myDomain=null;if(!(!inIframe()||$(window).width()<1||$(window).height()<1)){debug.log("Inside iframe with isdtp="+PopupUtils.getURLParameter("isdtp")+"\n"+window.location.href+"\n"+$(window).width()+","+$(window).height());var initIframe=function(request){if(request&&!(!inIframe()||$(window).width()<1||$(window).height()<1)&&($(window).on("keydown",function(e){return e.ctrlKey&&e.metaKey&&e.altKey&&e.shiftKey&&71===e.keyCode&&Grootanizer.grootanize(IS_LEX),chrome.runtime.sendMessage({action:"BKG-KEYDOWN",evt:{altKey:e.altKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey,keyCode:e.keyCode}})}),"vw"!=PopupUtils.getURLParameter("isdtp")&&"nv"!=PopupUtils.getURLParameter("isdtp")&&window.location.href.indexOf("/login/sessionserver")<0&&window.location.href.indexOf("ServiceDeskHistory.html")<0&&window.location.href.indexOf("/umps/UMPSWidget_184/")<0&&window.location.href.indexOf("/umps/sfdc_umps_frame")<0&&window.location.href.indexOf("/servlet/servlet.Integration")<0&&window.location.href.indexOf("appexchange.salesforce.com")<0&&window.location.href.indexOf("success.salesforce.com")<0&&window.location.href.indexOf("login.salesforce.com")<0&&window.location.href.indexOf("https://c.salesforce.com")<0&&window.location.href.indexOf("test.salesforce.com")<0)){if(debug.log("Inside listener with action "+request.action+" and isdtp="+PopupUtils.getURLParameter("isdtp")+"\n"+window.location.href+"\n"+$(window).width()+","+$(window).height()),"CNT-SET-ORG-PARAMS"===request.action){if(_oid||"BKG"!==request.from||(_oid=request.oid,_serverName=request.domain.split(".")[0]),debug.log("Received org: ",_oid,_myDomain,_serverName,request),_sid=request.sid,!_oid||!_sid)return;if(_oid!==request.oid)return;if(_domain=request.domain,_domainAPI=request.domainAPI,_tabColor=request.color,_tabTitle=request.title,_betaFeatures=request.betaFeatures,_apiLevel=request.apiLevel,!_sid)return;_betaFeatures.CHANGESET_HELPER&&(_betaFeatures.CHANGESET_HELPER!==!0&&"V1"!==_betaFeatures.CHANGESET_HELPER||ChangeSetHelper.isAllowed(IS_LEX)&&ChangeSetHelper.render(_sid,_oid,_domainAPI,IS_LEX,_apiLevel,function(){})),_formulaApplied||_betaFeatures&&!_betaFeatures.FORMULA_EDITOR||(_formulaApplied=!0,setTimeout(function(){FormulaEditor.apply(_betaFeatures.FORMULA_EDITOR_OPTIONS||{})},500)),$CodeCoverage.init(IS_LEX,_domainAPI,_sid,_apiLevel),_betaFeatures&&_betaFeatures.FIELD_HISTORY===!1||FieldHistoryUtils.render(IS_LEX,_domainAPI,_sid,_apiLevel),$IPWhitelistPlugin.render(_sid)}$ExtAPI.initContentListener(),CheckboxUtils.render()}},getOrgDetails=function(){debug.log('Calling "BKG-IS-LEX-TOP-FRAME"'),chrome.runtime.sendMessage({action:"BKG-IS-LEX-TOP-FRAME",isLex:IS_LEX}).then(function(resp){return debug.log("IS_LEX FROM BACKGROUND: ",resp),IS_LEX=resp.isLex,resp.orgParams?initIframe(resp.orgParams):setTimeout(getOrgDetails,2e3)})};getOrgDetails()}}),global.true=exports}({},function(){return this}());