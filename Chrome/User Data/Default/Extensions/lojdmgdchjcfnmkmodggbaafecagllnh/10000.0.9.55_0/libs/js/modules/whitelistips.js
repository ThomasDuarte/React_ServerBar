/* ORGanizer for Salesforce - v10000.0.9.53 
 * Author: Enrico Murru (https://organizer.solutions/)
 * Copyright 2016-2024
 */
!function(exports,global){define("whitelist-all-ips",["global","constants","jquery","popup-utils"],function($G,$C,$,PopupUtils){function initCounterElement(){counterElement.text("0 / "+IP_RANGE).addClass("ui-organizer-link").attr("title","The whitelist operation can take few minutes: don't worry if the counter rests for a while on 0.")}function addButton(enabled){var pbButton=$(".pbButton"),container=$('<div style="display:inline-block;"/>');allowAllButton=$("<input/>"),allowAllButton.attr("type","button"),allowAllButton.addClass("btn ui-organizer-input"),allowAllButton.attr("title","ORGanizer - Whitelist all IPs plugin : To enable this plugin jump to the Options page"),enabled?(allowAllButton.val("Whitelist All IPs"),allowAllButton.click(allowAll)):(allowAllButton.attr("disabled",!0),allowAllButton.val("Whitelist All IPs (disabled)")),container.append(allowAllButton),pbButton.append(container)}function createLoadingImage(){var container=$('<div style="display:inline-block;"/>'),loadingImage=$("<img />");return loadingImage.attr("src",chrome.runtime.getURL("/img/spin.gif")),loadingImage.width("15px"),container.append(loadingImage),container}function allowAll(){var pbButton=$(".pbButton");if(confirm("This will allow users to connect from every computer without verification code or security token. This might present a security threat. Would you like to proceed?")){allowAllButton.addClass("ui-organizer-input-disabled"),allowAllButton.unbind("click"),pbButton&&(pbButton.append(createLoadingImage()),pbButton.append(counterElement));for(var i=0;i<=IP_RANGE;i+=2)addIp(i)}}function addIp(ipPrefix){pendingIps[ipPrefix]=!0,request("/05G/e","get").then(function(result){var confirmationToken=result.match(/input type="hidden" name="_CONFIRMATIONTOKEN" id="_CONFIRMATIONTOKEN" value="([^"]*)"/)[1];return request("/05G/e?IpStartAddress="+ipPrefix+".0.0.0&IpEndAddress="+(ipPrefix+1)+".255.255.255&save=1&_CONFIRMATIONTOKEN="+confirmationToken,"post")}).then(function(result){pendingIps[ipPrefix]=!1;var ipsLeft=pendingIps.reduce(function(sum,curVal){return curVal?++sum:sum},0);counterElement.text(IP_RANGE-ipsLeft+"/"+IP_RANGE),0===ipsLeft&&location.reload()})}function request(url,method){return method=method||"GET","function"==typeof GM_xmlhttpRequest?new Promise(function(fulfill,reject){GM_xmlhttpRequest({method:method,url:url,headers:{Authorization:"Bearer "+sid,Accept:"*/*"},onload:function(response){0===response.status.toString().indexOf("2")?fulfill(response.response):reject(Error(response.statusText))},onerror:function(response){rejected(Error("Network Error"))}})}):new Promise(function(fulfill,reject){var xhr=new XMLHttpRequest;xhr.open(method,url),xhr.onload=function(){0===xhr.status.toString().indexOf("2")?fulfill(xhr.response):reject(Error(xhr.statusText))},xhr.onerror=function(){rejected(Error("Network Error"))},xhr.setRequestHeader("Authorization","Bearer "+sid),xhr.send()})}var sid,allowAllButton,_init=!1,pendingIps=[],IP_RANGE=255,counterElement=$('<div style="display:inline-block;"/>');PopupUtils.newDebugger("ORGanizer: whitelist IPs");return{render:function(sessionId){$G.window.location.href.indexOf("com/05G")<0||_init||(sid=sessionId,_init=!0,PopupUtils.getConfigParameterLocal([PopupUtils.StorageParamNameBetaFeatures],function(err,params){betaFeatures=params[PopupUtils.StorageParamNameBetaFeatures]||PopupUtils.BetaFeaturesDefault,addButton(betaFeatures.WHITELIST_IPS),betaFeatures.WHITELIST_IPS&&initCounterElement()}))}}}),global.true=exports}({},function(){return this}());